
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="My Professional Portoflio">
      
      
        <meta name="author" content="Salomon Marquez">
      
      
      
        <link rel="prev" href="../nextflow-for-rnaseq-aws/">
      
      
        <link rel="next" href="../../machine-learning/classification-splice-junction/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>Clinical Factors Associated with Survival in Gastrointestinal Cancer - </title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#clinical-factors-associated-with-survival-in-gastrointestinal-cancer" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Clinical Factors Associated with Survival in Gastrointestinal Cancer
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="black"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="black"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sblaizerwize/My-Professional-Portfolio" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    sblaizerwize/My-Professional-Portfolio
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../nextflow-for-rnaseq-aws/" class="md-tabs__link">
          
  
  
    
  
  Bioinformatics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../machine-learning/classification-splice-junction/" class="md-tabs__link">
          
  
  
    
  
  Machine Learning

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../natural-language-processing/a-journey-through-text-data-competitions/" class="md-tabs__link">
          
  
  
    
  
  Natural Language Processing

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../technical-writing/" class="md-tabs__link">
          
  
  
    
  
  Technical Writing

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sblaizerwize/My-Professional-Portfolio" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    sblaizerwize/My-Professional-Portfolio
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Bioinformatics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Bioinformatics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nextflow-for-rnaseq-aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nextflow RNA-seq pipelines Executed on AWS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Clinical Factors Associated with Survival in Gastrointestinal Cancer
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Clinical Factors Associated with Survival in Gastrointestinal Cancer
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-objective" class="md-nav__link">
    <span class="md-ellipsis">
      1 Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-data-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      2 Data Preparation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Data Preparation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-initial-dataset-exploration" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Initial Dataset Exploration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-target-questions" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Target Questions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-exploratory-data-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      3 Exploratory Data Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 Exploratory Data Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-descriptive-statistics-and-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Descriptive Statistics and Visualization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 Descriptive Statistics and Visualization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#question-1-what-is-the-correlation-between-the-pathological-stage-of-the-tumor-at-diagnosis-and-survival" class="md-nav__link">
    <span class="md-ellipsis">
      Question 1: What is the correlation between the pathological stage of the tumor at diagnosis and survival?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#question-2-are-there-significant-differences-in-survival-according-to-the-type-of-gastrointestinal-cancer" class="md-nav__link">
    <span class="md-ellipsis">
      Question 2: Are there significant differences in survival according to the type of gastrointestinal cancer?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Question 2: Are there significant differences in survival according to the type of gastrointestinal cancer?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anova-test" class="md-nav__link">
    <span class="md-ellipsis">
      ANOVA Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-of-model-residual-normality-assumptions" class="md-nav__link">
    <span class="md-ellipsis">
      Validation of Model Residual Normality Assumptions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kruskal-wallis-test" class="md-nav__link">
    <span class="md-ellipsis">
      Kruskal-Wallis Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kaplan-meier-survival-studies" class="md-nav__link">
    <span class="md-ellipsis">
      Kaplan-Meier Survival Studies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#question-3-what-survival-differences-are-observed-by-patient-gender-and-age" class="md-nav__link">
    <span class="md-ellipsis">
      Question 3: What survival differences are observed by patient gender and age?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Question 3: What survival differences are observed by patient gender and age?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kaplan-meier-survival-studies_1" class="md-nav__link">
    <span class="md-ellipsis">
      Kaplan-Meier Survival Studies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#question-4-what-is-the-impact-of-venous-lymphatic-or-perineural-invasion-on-survival" class="md-nav__link">
    <span class="md-ellipsis">
      Question 4: What is the impact of venous, lymphatic, or perineural invasion on survival?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Question 4: What is the impact of venous, lymphatic, or perineural invasion on survival?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kaplan-meier-survival-studies_2" class="md-nav__link">
    <span class="md-ellipsis">
      Kaplan-Meier Survival Studies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#question-5-what-is-the-bmi-distribution-of-patients-by-gender" class="md-nav__link">
    <span class="md-ellipsis">
      Question 5: What is the BMI distribution of patients by gender?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-probability-study" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Probability Study
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 Probability Study">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-a" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise A
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-b" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-c" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise C
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-machine-learning-models" class="md-nav__link">
    <span class="md-ellipsis">
      4 Machine Learning Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 Machine Learning Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-supervised-model-svm" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Supervised Model (SVM)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-pca-unsupervised-model" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 PCA - Unsupervised Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-visualization-with-shiny" class="md-nav__link">
    <span class="md-ellipsis">
      5 Visualization with Shiny
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-conclusions" class="md-nav__link">
    <span class="md-ellipsis">
      6 Conclusions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-bibliography" class="md-nav__link">
    <span class="md-ellipsis">
      7 Bibliography
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Machine Learning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Machine Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine-learning/classification-splice-junction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classification of DNA Splice Junctions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine-learning/used-car-predictions-for-kagglex-competition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Used Car Price Predictions Solution for the KaggleX Skill Assessment Challenge
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Natural Language Processing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Natural Language Processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../natural-language-processing/a-journey-through-text-data-competitions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A Journey Through Kaggle Text Data Competitions From 2021 to 2023
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../natural-language-processing/in-depth-analysis-of-kaggle-and-arxiv-datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    In Depth Analysis of Kaggle and Arxiv Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../natural-language-processing/analyzing-movie-genre-predictions-using-transformers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analyzing Movie Genre Predictions through the Lens of Hugging Face Transformers and a Training Loop Approach
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../natural-language-processing/higher_order_huggingface_models_for_movie_predictions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Movie Genre Prediction using Robust Model Architectures
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../technical-writing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Technical Writing
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Technical Writing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-objective" class="md-nav__link">
    <span class="md-ellipsis">
      1 Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-data-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      2 Data Preparation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Data Preparation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-initial-dataset-exploration" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Initial Dataset Exploration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-target-questions" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Target Questions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-exploratory-data-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      3 Exploratory Data Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 Exploratory Data Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-descriptive-statistics-and-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Descriptive Statistics and Visualization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 Descriptive Statistics and Visualization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#question-1-what-is-the-correlation-between-the-pathological-stage-of-the-tumor-at-diagnosis-and-survival" class="md-nav__link">
    <span class="md-ellipsis">
      Question 1: What is the correlation between the pathological stage of the tumor at diagnosis and survival?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#question-2-are-there-significant-differences-in-survival-according-to-the-type-of-gastrointestinal-cancer" class="md-nav__link">
    <span class="md-ellipsis">
      Question 2: Are there significant differences in survival according to the type of gastrointestinal cancer?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Question 2: Are there significant differences in survival according to the type of gastrointestinal cancer?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anova-test" class="md-nav__link">
    <span class="md-ellipsis">
      ANOVA Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-of-model-residual-normality-assumptions" class="md-nav__link">
    <span class="md-ellipsis">
      Validation of Model Residual Normality Assumptions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kruskal-wallis-test" class="md-nav__link">
    <span class="md-ellipsis">
      Kruskal-Wallis Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kaplan-meier-survival-studies" class="md-nav__link">
    <span class="md-ellipsis">
      Kaplan-Meier Survival Studies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#question-3-what-survival-differences-are-observed-by-patient-gender-and-age" class="md-nav__link">
    <span class="md-ellipsis">
      Question 3: What survival differences are observed by patient gender and age?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Question 3: What survival differences are observed by patient gender and age?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kaplan-meier-survival-studies_1" class="md-nav__link">
    <span class="md-ellipsis">
      Kaplan-Meier Survival Studies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#question-4-what-is-the-impact-of-venous-lymphatic-or-perineural-invasion-on-survival" class="md-nav__link">
    <span class="md-ellipsis">
      Question 4: What is the impact of venous, lymphatic, or perineural invasion on survival?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Question 4: What is the impact of venous, lymphatic, or perineural invasion on survival?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kaplan-meier-survival-studies_2" class="md-nav__link">
    <span class="md-ellipsis">
      Kaplan-Meier Survival Studies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#question-5-what-is-the-bmi-distribution-of-patients-by-gender" class="md-nav__link">
    <span class="md-ellipsis">
      Question 5: What is the BMI distribution of patients by gender?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-probability-study" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Probability Study
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 Probability Study">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-a" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise A
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-b" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-c" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise C
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-machine-learning-models" class="md-nav__link">
    <span class="md-ellipsis">
      4 Machine Learning Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 Machine Learning Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-supervised-model-svm" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Supervised Model (SVM)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-pca-unsupervised-model" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 PCA - Unsupervised Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-visualization-with-shiny" class="md-nav__link">
    <span class="md-ellipsis">
      5 Visualization with Shiny
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-conclusions" class="md-nav__link">
    <span class="md-ellipsis">
      6 Conclusions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-bibliography" class="md-nav__link">
    <span class="md-ellipsis">
      7 Bibliography
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="clinical-factors-associated-with-survival-in-gastrointestinal-cancer">Clinical Factors Associated with Survival in Gastrointestinal Cancer</h1>
<p>by <a href="https://es.linkedin.com/in/sefora-conti-6b313047">Sefora Conti</a> and <a href="https://www.linkedin.com/in/sblaizer/">Salomon Marquez</a></p>
<p>15/06/2025 </p>
<h2 id="1-objective">1 Objective</h2>
<p>Gastrointestinal cancer encompasses a group of malignant and heterogeneous neoplasms that affect different organs of the digestive system, including the biliary tract, the stomach, the pancreas, the colon, and the rectum. These diseases represent a significant proportion of the global cancer burden and often have unfavorable prognoses (1, 2). Identifying clinico-pathological factors that influence patients’ overall survival is essential for improving risk stratification, therapeutic decision-making, and the design of personalized follow-up strategies.</p>
<p>In recent years, several approaches have been developed to improve this prediction, including in vitro models (such as patient-derived organoids)(3–5), in vivo models (for example, xenografts in animal models)(6), and in silico strategies(7–9). The latter rely on different types of data, such as histopathological images(10), magnetic resonance imaging(11), or clinical information, to generate tools that help personalize cancer treatment.</p>
<p>In the present work, we analyze a publicly available clinical dataset from the <a href="https://portal.gdc.cancer.gov/">TCGA</a> (The Cancer Genome Atlas Program) repository using R, with the aim of identifying potential clinical factors associated with the survival of patients with gastrointestinal tumors. This analysis will explore possible correlations between pathological and demographic variables and overall survival, with the aim of providing evidence that improves patient stratification.</p>
<p>The data used are open access, anonymized, and their use for academic purposes is permitted under the policies of the <a href="https://gdc.cancer.gov/about-gdc/gdc-policies">GDC Data Portal</a>.</p>
<p>Visit the <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></span> <a href="https://github.com/sblaizerwize/My-Professional-Portfolio/tree/main/docs/bioinformatics/clinical-factors-associated-with-survival-in-gastrointestinal-cancer">repository of the project</a> to check out:<br />
- <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M96 0C60.7 0 32 28.7 32 64v384c0 35.3 28.7 64 64 64h80V400c0-35.3 28.7-64 64-64h176V170.5c0-17-6.7-33.3-18.7-45.3L290.7 18.7C278.7 6.7 262.5 0 245.5 0zm261.5 176H264c-13.3 0-24-10.7-24-24V58.5zM264 380c-24.3 0-44 19.7-44 44v80c0 24.3 19.7 44 44 44h16c24.3 0 44-19.7 44-44v-8c0-11-9-20-20-20s-20 9-20 20v8c0 2.2-1.8 4-4 4h-16c-2.2 0-4-1.8-4-4v-80c0-2.2 1.8-4 4-4h16c2.2 0 4 1.8 4 4v8c0 11 9 20 20 20s20-9 20-20v-8c0-24.3-19.7-44-44-44zm136 0c-28.7 0-52 23.3-52 52s23.3 52 52 52c6.6 0 12 5.4 12 12s-5.4 12-12 12h-32c-11 0-20 9-20 20s9 20 20 20h32c28.7 0 52-23.3 52-52s-23.3-52-52-52c-6.6 0-12-5.4-12-12s5.4-12 12-12h24c11 0 20-9 20-20s-9-20-20-20zm96 0c-11 0-20 9-20 20v31.6c0 35.5 10.5 70.3 30.2 99.8l5.1 7.7c3.7 5.6 10 8.9 16.6 8.9s12.9-3.3 16.6-8.9l5.1-7.7c19.7-29.6 30.2-64.3 30.2-99.8V400c0-11-9-20-20-20s-20 9-20 20v31.6c0 19.6-4.1 38.9-12 56.7-7.9-17.8-12-37.1-12-56.7V400c0-11-9-20-20-20z"/></svg></span> TCGA data<br />
- <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215m-6.56 0a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"/></svg></span> R code<br />
- <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 2H3c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 18H3V6h18z"/></svg></span> Shiny application  </p>
<hr />
<h2 id="2-data-preparation">2 Data Preparation</h2>
<h3 id="21-initial-dataset-exploration">2.1 Initial Dataset Exploration</h3>
<p>The following table shows a general description of the TCGA dataset. The following sections show how this information was obtained.</p>
<table>
<thead>
<tr>
<th>Key Points</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>File Type and Data</strong></td>
<td>The dataset was imported from a semicolon-delimited .csv file, containing clinical and pathological information of cancer patients. It includes variables such as age, cancer type, presence of venous or perineural invasion, microsatellite instability, and follow-up variables such as days to last contact or death. Due to its combined origin (different clinical sources within TCGA), the dataset requires considerable preprocessing to make it suitable for analysis.</td>
</tr>
<tr>
<td><strong>Available Variables</strong></td>
<td>Categorical variables (e.g., cancer type, sex) and continuous variables (age, weight, height, etc.)</td>
</tr>
<tr>
<td><strong>Dataset Dimensions</strong></td>
<td>The dataset includes 154 clinical variables from 1,308 patients, of which we have selected 34 variables considered most relevant for the study objective.</td>
</tr>
<tr>
<td><strong>Detection of Missing Values</strong></td>
<td>There are 135,291 missing values in the original dataset and 21,007 in the new dataset (with the 34 selected variables).</td>
</tr>
<tr>
<td><strong>Inconsistencies</strong></td>
<td>Typical inconsistencies in clinical data were detected, such as mismatches between vital status and follow-up or death dates. To calculate overall survival, it was necessary to create a new survival time variable (<code>os_time</code>) combining <code>days_to_death</code> and <code>days_to_last_followup</code>, as well as a binary event variable (<code>os_event</code>).</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># Cargar el conjunto de datos (csv)</span>
<span class="n">df_TCGA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;Combined_TCGA_Clinical_300525.csv&quot;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;;&quot;</span><span class="p">)</span>
<span class="c1"># Visualizar registros</span>
<span class="nf">head</span><span class="p">(</span><span class="n">df_TCGA</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">],</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c1">#mostramos los primeros 3 registros</span>
</code></pre></div>
<pre><code>##   bcr_patient_barcode additional_studies tumor_tissue_site
## 1        TCGA-3L-AA1B               &lt;NA&gt;             Colon
## 2        TCGA-4N-A93T               &lt;NA&gt;             Colon
## 3        TCGA-4T-AA8H               &lt;NA&gt;             Colon
##               histological_type other_dx
## 1          Colon Adenocarcinoma       No
## 2          Colon Adenocarcinoma       No
## 3 Colon Mucinous Adenocarcinoma       No
</code></pre>
<div class="highlight"><pre><span></span><code><span class="nf">tail</span><span class="p">(</span><span class="n">df_TCGA</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">],</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c1">#mostramos los ultimos 3 registros</span>
</code></pre></div>
<pre><code>##      bcr_patient_barcode additional_studies tumor_tissue_site
## 1306        TCGA-Z5-AAPL               &lt;NA&gt;          Pancreas
## 1307                &lt;NA&gt;               &lt;NA&gt;              &lt;NA&gt;
## 1308                                                         
##                        histological_type other_dx
## 1306 Pancreas-Adenocarcinoma Ductal Type       No
## 1307                                &lt;NA&gt;     &lt;NA&gt;
## 1308
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Obtener el número de variables y sus nombres</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">df_TCGA</span><span class="p">)</span><span class="w"> </span><span class="c1">#dimensiones de df</span>
</code></pre></div>
<pre><code>## [1] 1308  154
</code></pre>
<div class="highlight"><pre><span></span><code><span class="nf">names</span><span class="p">(</span><span class="n">df_TCGA</span><span class="p">)</span><span class="w"> </span><span class="c1">#nombres de las variables</span>
</code></pre></div>
<pre><code>##   [1] "bcr_patient_barcode"                                       
##   [2] "additional_studies"                                        
##   [3] "tumor_tissue_site"                                         
##   [4] "histological_type"                                         
##   [5] "other_dx"                                                  
##   [6] "gender"                                                    
##   [7] "vital_status"                                              
##   [8] "days_to_birth"                                             
##   [9] "days_to_last_known_alive"                                  
##  [10] "days_to_death"                                             
##  [11] "days_to_last_followup"                                     
##  [12] "race_list"                                                 
##  [13] "tissue_source_site"                                        
##  [14] "patient_id"                                                
##  [15] "bcr_patient_uuid"                                          
##  [16] "history_of_neoadjuvant_treatment"                          
##  [17] "informed_consent_verified"                                 
##  [18] "icd_o_3_site"                                              
##  [19] "icd_o_3_histology"                                         
##  [20] "icd_10"                                                    
##  [21] "tissue_prospective_collection_indicator"                   
##  [22] "tissue_retrospective_collection_indicator"                 
##  [23] "days_to_initial_pathologic_diagnosis"                      
##  [24] "age_at_initial_pathologic_diagnosis"                       
##  [25] "year_of_initial_pathologic_diagnosis"                      
##  [26] "person_neoplasm_cancer_status"                             
##  [27] "ethnicity"                                                 
##  [28] "weight"                                                    
##  [29] "height"                                                    
##  [30] "day_of_form_completion"                                    
##  [31] "month_of_form_completion"                                  
##  [32] "year_of_form_completion"                                   
##  [33] "residual_tumor"                                            
##  [34] "anatomic_neoplasm_subdivision"                             
##  [35] "primary_lymph_node_presentation_assessment"                
##  [36] "lymph_node_examined_count"                                 
##  [37] "number_of_lymphnodes_positive_by_he"                       
##  [38] "number_of_lymphnodes_positive_by_ihc"                      
##  [39] "preoperative_pretreatment_cea_level"                       
##  [40] "non_nodal_tumor_deposits"                                  
##  [41] "circumferential_resection_margin"                          
##  [42] "venous_invasion"                                           
##  [43] "lymphatic_invasion"                                        
##  [44] "perineural_invasion_present"                               
##  [45] "microsatellite_instability"                                
##  [46] "number_of_loci_tested"                                     
##  [47] "number_of_abnormal_loci"                                   
##  [48] "kras_gene_analysis_performed"                              
##  [49] "kras_mutation_found"                                       
##  [50] "kras_mutation_codon"                                       
##  [51] "braf_gene_analysis_performed"                              
##  [52] "braf_gene_analysis_result"                                 
##  [53] "synchronous_colon_cancer_present"                          
##  [54] "history_of_colon_polyps"                                   
##  [55] "colon_polyps_present"                                      
##  [56] "loss_expression_of_mismatch_repair_proteins_by_ihc"        
##  [57] "loss_expression_of_mismatch_repair_proteins_by_ihc_results"
##  [58] "number_of_first_degree_relatives_with_cancer_diagnosis"    
##  [59] "radiation_therapy"                                         
##  [60] "postoperative_rx_tx"                                       
##  [61] "primary_therapy_outcome_success"                           
##  [62] "has_new_tumor_events_information"                          
##  [63] "has_drugs_information"                                     
##  [64] "has_radiations_information"                                
##  [65] "has_follow_ups_information"                                
##  [66] "project"                                                   
##  [67] "stage_event_system_version"                                
##  [68] "stage_event_clinical_stage"                                
##  [69] "stage_event_pathologic_stage"                              
##  [70] "stage_event_tnm_categories"                                
##  [71] "stage_event_psa"                                           
##  [72] "stage_event_gleason_grading"                               
##  [73] "stage_event_ann_arbor"                                     
##  [74] "stage_event_serum_markers"                                 
##  [75] "stage_event_igcccg_stage"                                  
##  [76] "stage_event_masaoka_stage"                                 
##  [77] "cancer_type"                                               
##  [78] "patient_death_reason"                                      
##  [79] "anatomic_neoplasm_subdivision_other"                       
##  [80] "neoplasm_histologic_grade"                                 
##  [81] "country_of_procurement"                                    
##  [82] "city_of_procurement"                                       
##  [83] "reflux_history"                                            
##  [84] "antireflux_treatment"                                      
##  [85] "antireflux_treatment_types"                                
##  [86] "barretts_esophagus"                                        
##  [87] "h_pylori_infection"                                        
##  [88] "family_history_of_stomach_cancer"                          
##  [89] "number_of_relatives_with_stomach_cancer"                   
##  [90] "relative_family_cancer_history"                            
##  [91] "cancer_first_degree_relative"                              
##  [92] "blood_relative_cancer_history_list"                        
##  [93] "history_hepato_carcinoma_risk_factors"                     
##  [94] "post_op_ablation_embolization_tx"                          
##  [95] "eastern_cancer_oncology_group"                             
##  [96] "primary_pathology_tumor_tissue_site"                       
##  [97] "primary_pathology_histological_type"                       
##  [98] "primary_pathology_specimen_collection_method_name"         
##  [99] "primary_pathology_history_prior_surgery_type_other"        
## [100] "primary_pathology_days_to_initial_pathologic_diagnosis"    
## [101] "primary_pathology_age_at_initial_pathologic_diagnosis"     
## [102] "primary_pathology_year_of_initial_pathologic_diagnosis"    
## [103] "primary_pathology_neoplasm_histologic_grade"               
## [104] "primary_pathology_residual_tumor"                          
## [105] "primary_pathology_vascular_tumor_cell_type"                
## [106] "primary_pathology_perineural_invasion_present"             
## [107] "primary_pathology_child_pugh_classification_grade"         
## [108] "primary_pathology_ca_19_9_level"                           
## [109] "primary_pathology_ca_19_9_level_lower"                     
## [110] "primary_pathology_ca_19_9_level_upper"                     
## [111] "primary_pathology_fetoprotein_outcome_value"               
## [112] "primary_pathology_fetoprotein_outcome_lower_limit"         
## [113] "primary_pathology_fetoprotein_outcome_upper_limit"         
## [114] "primary_pathology_platelet_result_count"                   
## [115] "primary_pathology_platelet_result_lower_limit"             
## [116] "primary_pathology_platelet_result_upper_limit"             
## [117] "primary_pathology_prothrombin_time_result_value"           
## [118] "primary_pathology_inter_norm_ratio_lower_limit"            
## [119] "primary_pathology_intern_norm_ratio_upper_limit"           
## [120] "primary_pathology_albumin_result_specified_value"          
## [121] "primary_pathology_albumin_result_lower_limit"              
## [122] "primary_pathology_albumin_result_upper_limit"              
## [123] "primary_pathology_bilirubin_upper_limit"                   
## [124] "primary_pathology_bilirubin_lower_limit"                   
## [125] "primary_pathology_total_bilirubin_upper_limit"             
## [126] "primary_pathology_creatinine_value_in_mg_dl"               
## [127] "primary_pathology_creatinine_lower_level"                  
## [128] "primary_pathology_creatinine_upper_limit"                  
## [129] "primary_pathology_fibrosis_ishak_score"                    
## [130] "primary_pathology_cholangitis_tissue_evidence"             
## [131] "adenocarcinoma_invasion"                                   
## [132] "histological_type_other"                                   
## [133] "tumor_type"                                                
## [134] "initial_pathologic_diagnosis_method"                       
## [135] "init_pathology_dx_method_other"                            
## [136] "surgery_performed_type"                                    
## [137] "histologic_grading_tier_category"                          
## [138] "maximum_tumor_dimension"                                   
## [139] "source_of_patient_death_reason"                            
## [140] "tobacco_smoking_history"                                   
## [141] "year_of_tobacco_smoking_onset"                             
## [142] "stopped_smoking_year"                                      
## [143] "number_pack_years_smoked"                                  
## [144] "alcohol_history_documented"                                
## [145] "alcoholic_exposure_category"                               
## [146] "frequency_of_alcohol_consumption"                          
## [147] "amount_of_alcohol_consumption_per_day"                     
## [148] "history_of_diabetes"                                       
## [149] "days_to_diabetes_onset"                                    
## [150] "history_of_chronic_pancreatitis"                           
## [151] "days_to_pancreatitis_onset"                                
## [152] "family_history_of_cancer"                                  
## [153] "relative_cancer_types"                                     
## [154] "history_prior_surgery_type_other"
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Visualizar estructura del conjunto de datos y un resumen estadístico</span>
<span class="nf">str</span><span class="p">(</span><span class="n">df_TCGA</span><span class="p">)</span>
</code></pre></div>
<pre><code>## 'data.frame':    1308 obs. of  154 variables:
##  $ bcr_patient_barcode                                       : chr  "TCGA-3L-AA1B" "TCGA-4N-A93T" "TCGA-4T-AA8H" "TCGA-5M-AAT4" ...
##  $ additional_studies                                        : chr  NA NA NA NA ...
##  $ tumor_tissue_site                                         : chr  "Colon" "Colon" "Colon" "Colon" ...
##  $ histological_type                                         : chr  "Colon Adenocarcinoma" "Colon Adenocarcinoma" "Colon Mucinous Adenocarcinoma" "Colon Adenocarcinoma" ...
##  $ other_dx                                                  : chr  "No" "No" "No" "No" ...
##  $ gender                                                    : chr  "FEMALE" "MALE" "FEMALE" "MALE" ...
##  $ vital_status                                              : chr  NA NA NA "Dead" ...
##  $ days_to_birth                                             : int  -22379 -24523 -15494 -27095 -14852 -27870 -16512 -31329 -30237 -26292 ...
##  $ days_to_last_known_alive                                  : int  NA NA NA NA NA NA 424 NA NA NA ...
##  $ days_to_death                                             : int  NA NA NA 49 290 NA NA 1126 NA NA ...
##  $ days_to_last_followup                                     : num  475 146 385 -Inf -Inf ...
##  $ race_list                                                 : chr  "BLACK OR AFRICAN AMERICAN" "BLACK OR AFRICAN AMERICAN" "BLACK OR AFRICAN AMERICAN" "BLACK OR AFRICAN AMERICAN" ...
##  $ tissue_source_site                                        : chr  "3L" "4N" "4T" "5M" ...
##  $ patient_id                                                : chr  "AA1B" "A93T" "AA8H" "AAT4" ...
##  $ bcr_patient_uuid                                          : chr  "A94E1279-A975-480A-93E9-7B1FF05CBCBF" "92554413-9EBC-4354-8E1B-9682F3A031D9" "A5E14ADD-1552-4606-9FFE-3A03BCF76640" "1136DD50-242A-4659-AAD4-C53F9E759BB3" ...
##  $ history_of_neoadjuvant_treatment                          : chr  "No" "No" "No" "No" ...
##  $ informed_consent_verified                                 : chr  "YES" "YES" "YES" "YES" ...
##  $ icd_o_3_site                                              : chr  "C18.0" "C18.2" "C18.6" "C18.2" ...
##  $ icd_o_3_histology                                         : chr  "01/03/8140" "01/03/8140" "01/03/8480" "01/03/8140" ...
##  $ icd_10                                                    : chr  "C18.0" "C18.2" "C18.6" "C18.2" ...
##  $ tissue_prospective_collection_indicator                   : chr  "YES" "YES" "NO" "NO" ...
##  $ tissue_retrospective_collection_indicator                 : chr  "NO" "NO" "YES" "YES" ...
##  $ days_to_initial_pathologic_diagnosis                      : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ age_at_initial_pathologic_diagnosis                       : int  61 67 42 74 40 76 45 85 82 71 ...
##  $ year_of_initial_pathologic_diagnosis                      : int  2013 2013 2013 2009 2009 2011 2009 2009 2009 2009 ...
##  $ person_neoplasm_cancer_status                             : chr  "TUMOR FREE" "WITH TUMOR" "TUMOR FREE" "WITH TUMOR" ...
##  $ ethnicity                                                 : chr  "NOT HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" "HISPANIC OR LATINO" ...
##  $ weight                                                    : num  63.3 134 108 NA 99.1 ...
##  $ height                                                    : num  173 168 168 NA 162 ...
##  $ day_of_form_completion                                    : int  22 1 5 27 27 27 14 28 4 15 ...
##  $ month_of_form_completion                                  : int  4 10 6 1 1 1 10 1 10 10 ...
##  $ year_of_form_completion                                   : int  2014 2014 2014 2015 2015 2015 2010 2011 2010 2010 ...
##  $ residual_tumor                                            : chr  "R0" "R0" "R0" "R0" ...
##  $ anatomic_neoplasm_subdivision                             : chr  "Cecum" "Ascending Colon" "Descending Colon" "Ascending Colon" ...
##  $ primary_lymph_node_presentation_assessment                : chr  "YES" "YES" "YES" "YES" ...
##  $ lymph_node_examined_count                                 : int  28 25 24 3 11 15 22 27 29 20 ...
##  $ number_of_lymphnodes_positive_by_he                       : int  0 NA 0 0 10 0 NA 3 1 7 ...
##  $ number_of_lymphnodes_positive_by_ihc                      : int  0 2 NA 0 0 0 NA NA NA 0 ...
##  $ preoperative_pretreatment_cea_level                       : num  NA 2 NA 550 2.61 2.91 NA 17.4 3.4 32.8 ...
##  $ non_nodal_tumor_deposits                                  : chr  "NO" "YES" "NO" "NO" ...
##  $ circumferential_resection_margin                          : num  NA 30 20 NA NA NA NA NA NA NA ...
##  $ venous_invasion                                           : chr  "NO" "NO" "NO" "YES" ...
##  $ lymphatic_invasion                                        : chr  "NO" "NO" "NO" NA ...
##  $ perineural_invasion_present                               : chr  "NO" "NO" "NO" NA ...
##  $ microsatellite_instability                                : chr  "NO" NA "NO" NA ...
##  $ number_of_loci_tested                                     : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ number_of_abnormal_loci                                   : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ kras_gene_analysis_performed                              : chr  "NO" "NO" "NO" "NO" ...
##  $ kras_mutation_found                                       : chr  NA NA NA NA ...
##  $ kras_mutation_codon                                       : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ braf_gene_analysis_performed                              : chr  "NO" "NO" "NO" "NO" ...
##  $ braf_gene_analysis_result                                 : chr  NA NA NA NA ...
##  $ synchronous_colon_cancer_present                          : chr  "NO" "YES" "NO" "NO" ...
##  $ history_of_colon_polyps                                   : chr  "YES" "NO" "NO" "NO" ...
##  $ colon_polyps_present                                      : chr  "YES" "YES" "NO" "YES" ...
##  $ loss_expression_of_mismatch_repair_proteins_by_ihc        : chr  "YES" "YES" "YES" "NO" ...
##  $ loss_expression_of_mismatch_repair_proteins_by_ihc_results: chr  "MLH1-ExpressedMSH2-ExpressedPMS2-ExpressedMSH6-Expressed" "MLH1-ExpressedMSH2-ExpressedPMS2-ExpressedMSH6-Expressed" "MLH1-ExpressedMSH2-ExpressedPMS2-ExpressedMSH6-Expressed" NA ...
##  $ number_of_first_degree_relatives_with_cancer_diagnosis    : int  0 0 0 0 NA 0 0 0 0 0 ...
##  $ radiation_therapy                                         : chr  "NO" "NO" "NO" "NO" ...
##  $ postoperative_rx_tx                                       : chr  "NO" "YES" "NO" "NO" ...
##  $ primary_therapy_outcome_success                           : chr  "Complete Remission/Response" "Stable Disease" "Complete Remission/Response" "Progressive Disease" ...
##  $ has_new_tumor_events_information                          : chr  "NO" "NO" "NO" "NO" ...
##  $ has_drugs_information                                     : chr  "NO" "YES" "NO" "NO" ...
##  $ has_radiations_information                                : chr  "NO" "NO" "NO" "NO" ...
##  $ has_follow_ups_information                                : chr  "YES" "YES" "YES" "YES" ...
##  $ project                                                   : chr  "TCGA-COAD" "TCGA-COAD" "TCGA-COAD" "TCGA-COAD" ...
##  $ stage_event_system_version                                : chr  "7th" "7th" "7th" "6th" ...
##  $ stage_event_clinical_stage                                : logi  NA NA NA NA NA NA ...
##  $ stage_event_pathologic_stage                              : chr  "Stage I" "Stage IIIB" "Stage IIA" "Stage IV" ...
##  $ stage_event_tnm_categories                                : chr  "T2N0M0" "T4aN1bM0" "T3N0MX" "T3N0M1b" ...
##  $ stage_event_psa                                           : logi  NA NA NA NA NA NA ...
##  $ stage_event_gleason_grading                               : logi  NA NA NA NA NA NA ...
##  $ stage_event_ann_arbor                                     : logi  NA NA NA NA NA NA ...
##  $ stage_event_serum_markers                                 : logi  NA NA NA NA NA NA ...
##  $ stage_event_igcccg_stage                                  : logi  NA NA NA NA NA NA ...
##  $ stage_event_masaoka_stage                                 : logi  NA NA NA NA NA NA ...
##  $ cancer_type                                               : chr  "TCGA-COAD" "TCGA-COAD" "TCGA-COAD" "TCGA-COAD" ...
##  $ patient_death_reason                                      : chr  NA NA NA NA ...
##  $ anatomic_neoplasm_subdivision_other                       : chr  NA NA NA NA ...
##  $ neoplasm_histologic_grade                                 : chr  NA NA NA NA ...
##  $ country_of_procurement                                    : chr  NA NA NA NA ...
##  $ city_of_procurement                                       : chr  NA NA NA NA ...
##  $ reflux_history                                            : chr  NA NA NA NA ...
##  $ antireflux_treatment                                      : chr  NA NA NA NA ...
##  $ antireflux_treatment_types                                : chr  NA NA NA NA ...
##  $ barretts_esophagus                                        : chr  NA NA NA NA ...
##  $ h_pylori_infection                                        : chr  NA NA NA NA ...
##  $ family_history_of_stomach_cancer                          : chr  NA NA NA NA ...
##  $ number_of_relatives_with_stomach_cancer                   : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ relative_family_cancer_history                            : chr  NA NA NA NA ...
##  $ cancer_first_degree_relative                              : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ blood_relative_cancer_history_list                        : chr  NA NA NA NA ...
##  $ history_hepato_carcinoma_risk_factors                     : chr  NA NA NA NA ...
##  $ post_op_ablation_embolization_tx                          : chr  NA NA NA NA ...
##  $ eastern_cancer_oncology_group                             : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ primary_pathology_tumor_tissue_site                       : chr  NA NA NA NA ...
##  $ primary_pathology_histological_type                       : chr  NA NA NA NA ...
##  $ primary_pathology_specimen_collection_method_name         : chr  NA NA NA NA ...
##  $ primary_pathology_history_prior_surgery_type_other        : chr  NA NA NA NA ...
##   [list output truncated]
</code></pre>
<div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="n">df_TCGA</span><span class="p">)</span>
</code></pre></div>
<pre><code>##  bcr_patient_barcode additional_studies tumor_tissue_site  histological_type 
##  Length:1308         Length:1308        Length:1308        Length:1308       
##  Class :character    Class :character   Class :character   Class :character  
##  Mode  :character    Mode  :character   Mode  :character   Mode  :character  
##                                                                              
##                                                                              
##                                                                              
##                                                                              
##    other_dx            gender          vital_status       days_to_birth   
##  Length:1308        Length:1308        Length:1308        Min.   :-32873  
##  Class :character   Class :character   Class :character   1st Qu.:-27321  
##  Mode  :character   Mode  :character   Mode  :character   Median :-24655  
##                                                           Mean   :-24204  
##                                                           3rd Qu.:-21319  
##                                                           Max.   :-10659  
##                                                           NA's   :17      
##  days_to_last_known_alive days_to_death    days_to_last_followup
##  Min.   :   0.0           Min.   :   0.0   Min.   :-Inf         
##  1st Qu.: 343.5           1st Qu.: 145.0   1st Qu.:   0         
##  Median : 992.0           Median : 366.0   Median : 485         
##  Mean   :1635.1           Mean   : 503.5   Mean   :-Inf         
##  3rd Qu.:3223.0           3rd Qu.: 641.0   3rd Qu.: 942         
##  Max.   :3920.0           Max.   :3042.0   Max.   :4502         
##  NA's   :1289             NA's   :1071     NA's   :205          
##   race_list         tissue_source_site  patient_id        bcr_patient_uuid  
##  Length:1308        Length:1308        Length:1308        Length:1308       
##  Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##                                                                             
##                                                                             
##                                                                             
##                                                                             
##  history_of_neoadjuvant_treatment informed_consent_verified icd_o_3_site      
##  Length:1308                      Length:1308               Length:1308       
##  Class :character                 Class :character          Class :character  
##  Mode  :character                 Mode  :character          Mode  :character  
##                                                                               
##                                                                               
##                                                                               
##                                                                               
##  icd_o_3_histology     icd_10          tissue_prospective_collection_indicator
##  Length:1308        Length:1308        Length:1308                            
##  Class :character   Class :character   Class :character                       
##  Mode  :character   Mode  :character   Mode  :character                       
##                                                                               
##                                                                               
##                                                                               
##                                                                               
##  tissue_retrospective_collection_indicator days_to_initial_pathologic_diagnosis
##  Length:1308                               Min.   :0                           
##  Class :character                          1st Qu.:0                           
##  Mode  :character                          Median :0                           
##                                            Mean   :0                           
##                                            3rd Qu.:0                           
##                                            Max.   :0                           
##                                            NA's   :58                          
##  age_at_initial_pathologic_diagnosis year_of_initial_pathologic_diagnosis
##  Min.   :30.00                       Min.   :1996                        
##  1st Qu.:58.00                       1st Qu.:2008                        
##  Median :67.00                       Median :2010                        
##  Mean   :65.85                       Mean   :2009                        
##  3rd Qu.:74.00                       3rd Qu.:2011                        
##  Max.   :90.00                       Max.   :2013                        
##  NA's   :56                          NA's   :53                          
##  person_neoplasm_cancer_status  ethnicity             weight      
##  Length:1308                   Length:1308        Min.   : 34.00  
##  Class :character              Class :character   1st Qu.: 65.00  
##  Mode  :character              Mode  :character   Median : 78.05  
##                                                   Mean   : 80.44  
##                                                   3rd Qu.: 91.85  
##                                                   Max.   :175.30  
##                                                   NA's   :936     
##      height      day_of_form_completion month_of_form_completion
##  Min.   : 80.3   Min.   : 1.00          Min.   : 1.000          
##  1st Qu.:162.0   1st Qu.:11.00          1st Qu.: 4.000          
##  Median :170.0   Median :18.00          Median : 6.000          
##  Mean   :168.9   Mean   :16.62          Mean   : 5.881          
##  3rd Qu.:176.0   3rd Qu.:22.00          3rd Qu.: 7.000          
##  Max.   :193.0   Max.   :31.00          Max.   :12.000          
##  NA's   :957     NA's   :41             NA's   :5               
##  year_of_form_completion residual_tumor     anatomic_neoplasm_subdivision
##  Min.   :2010            Length:1308        Length:1308                  
##  1st Qu.:2011            Class :character   Class :character             
##  Median :2011            Mode  :character   Mode  :character             
##  Mean   :2012                                                            
##  3rd Qu.:2013                                                            
##  Max.   :2015                                                            
##  NA's   :5                                                               
##  primary_lymph_node_presentation_assessment lymph_node_examined_count
##  Length:1308                                Min.   :  0.00           
##  Class :character                           1st Qu.: 12.00           
##  Mode  :character                           Median : 18.00           
##                                             Mean   : 21.42           
##                                             3rd Qu.: 27.00           
##                                             Max.   :109.00           
##                                             NA's   :138              
##  number_of_lymphnodes_positive_by_he number_of_lymphnodes_positive_by_ihc
##  Min.   : 0.000                      Min.   : 0.0000                     
##  1st Qu.: 0.000                      1st Qu.: 0.0000                     
##  Median : 1.000                      Median : 0.0000                     
##  Mean   : 3.493                      Mean   : 0.2833                     
##  3rd Qu.: 4.000                      3rd Qu.: 0.0000                     
##  Max.   :57.000                      Max.   :12.0000                     
##  NA's   :143                         NA's   :1188                        
##  preoperative_pretreatment_cea_level non_nodal_tumor_deposits
##  Min.   :   0.000                    Length:1308             
##  1st Qu.:   1.700                    Class :character        
##  Median :   3.160                    Mode  :character        
##  Mean   :  65.074                                            
##  3rd Qu.:   8.982                                            
##  Max.   :7868.000                                            
##  NA's   :906                                                 
##  circumferential_resection_margin venous_invasion    lymphatic_invasion
##  Min.   :  0.00                   Length:1308        Length:1308       
##  1st Qu.:  2.50                   Class :character   Class :character  
##  Median : 13.00                   Mode  :character   Mode  :character  
##  Mean   : 22.96                                                        
##  3rd Qu.: 30.00                                                        
##  Max.   :165.00                                                        
##  NA's   :1185                                                          
##  perineural_invasion_present microsatellite_instability number_of_loci_tested
##  Length:1308                 Length:1308                Min.   : 0.000       
##  Class :character            Class :character           1st Qu.: 5.000       
##  Mode  :character            Mode  :character           Median : 5.000       
##                                                         Mean   : 4.944       
##                                                         3rd Qu.: 5.000       
##                                                         Max.   :10.000       
##                                                         NA's   :1236         
##  number_of_abnormal_loci kras_gene_analysis_performed kras_mutation_found
##  Min.   :0.0000          Length:1308                  Length:1308        
##  1st Qu.:0.0000          Class :character             Class :character   
##  Median :0.0000          Mode  :character             Mode  :character   
##  Mean   :0.5915                                                          
##  3rd Qu.:0.0000                                                          
##  Max.   :9.0000                                                          
##  NA's   :1237                                                            
##  kras_mutation_codon braf_gene_analysis_performed braf_gene_analysis_result
##  Min.   :12.00       Length:1308                  Length:1308              
##  1st Qu.:12.00       Class :character             Class :character         
##  Median :12.00       Mode  :character             Mode  :character         
##  Mean   :13.83                                                             
##  3rd Qu.:12.00                                                             
##  Max.   :61.00                                                             
##  NA's   :1278                                                              
##  synchronous_colon_cancer_present history_of_colon_polyps colon_polyps_present
##  Length:1308                      Length:1308             Length:1308         
##  Class :character                 Class :character        Class :character    
##  Mode  :character                 Mode  :character        Mode  :character    
##                                                                               
##                                                                               
##                                                                               
##                                                                               
##  loss_expression_of_mismatch_repair_proteins_by_ihc
##  Length:1308                                       
##  Class :character                                  
##  Mode  :character                                  
##                                                    
##                                                    
##                                                    
##                                                    
##  loss_expression_of_mismatch_repair_proteins_by_ihc_results
##  Length:1308                                               
##  Class :character                                          
##  Mode  :character                                          
##                                                            
##                                                            
##                                                            
##                                                            
##  number_of_first_degree_relatives_with_cancer_diagnosis radiation_therapy 
##  Min.   :0.0000                                         Length:1308       
##  1st Qu.:0.0000                                         Class :character  
##  Median :0.0000                                         Mode  :character  
##  Mean   :0.1654                                                           
##  3rd Qu.:0.0000                                                           
##  Max.   :3.0000                                                           
##  NA's   :770                                                              
##  postoperative_rx_tx primary_therapy_outcome_success
##  Length:1308         Length:1308                    
##  Class :character    Class :character               
##  Mode  :character    Mode  :character               
##                                                     
##                                                     
##                                                     
##                                                     
##  has_new_tumor_events_information has_drugs_information
##  Length:1308                      Length:1308          
##  Class :character                 Class :character     
##  Mode  :character                 Mode  :character     
##                                                        
##                                                        
##                                                        
##                                                        
##  has_radiations_information has_follow_ups_information   project         
##  Length:1308                Length:1308                Length:1308       
##  Class :character           Class :character           Class :character  
##  Mode  :character           Mode  :character           Mode  :character  
##                                                                          
##                                                                          
##                                                                          
##                                                                          
##  stage_event_system_version stage_event_clinical_stage
##  Length:1308                Mode:logical              
##  Class :character           NA's:1308                 
##  Mode  :character                                     
##                                                       
##                                                       
##                                                       
##                                                       
##  stage_event_pathologic_stage stage_event_tnm_categories stage_event_psa
##  Length:1308                  Length:1308                Mode:logical   
##  Class :character             Class :character           NA's:1308      
##  Mode  :character             Mode  :character                          
##                                                                         
##                                                                         
##                                                                         
##                                                                         
##  stage_event_gleason_grading stage_event_ann_arbor stage_event_serum_markers
##  Mode:logical                Mode:logical          Mode:logical             
##  NA's:1308                   NA's:1308             NA's:1308                
##                                                                             
##                                                                             
##                                                                             
##                                                                             
##                                                                             
##  stage_event_igcccg_stage stage_event_masaoka_stage cancer_type       
##  Mode:logical             Mode:logical              Length:1308       
##  NA's:1308                NA's:1308                 Class :character  
##                                                     Mode  :character  
##                                                                       
##                                                                       
##                                                                       
##                                                                       
##  patient_death_reason anatomic_neoplasm_subdivision_other
##  Length:1308          Length:1308                        
##  Class :character     Class :character                   
##  Mode  :character     Mode  :character                   
##                                                          
##                                                          
##                                                          
##                                                          
##  neoplasm_histologic_grade country_of_procurement city_of_procurement
##  Length:1308               Length:1308            Length:1308        
##  Class :character          Class :character       Class :character   
##  Mode  :character          Mode  :character       Mode  :character   
##                                                                      
##                                                                      
##                                                                      
##                                                                      
##  reflux_history     antireflux_treatment antireflux_treatment_types
##  Length:1308        Length:1308          Length:1308               
##  Class :character   Class :character     Class :character          
##  Mode  :character   Mode  :character     Mode  :character          
##                                                                    
##                                                                    
##                                                                    
##                                                                    
##  barretts_esophagus h_pylori_infection family_history_of_stomach_cancer
##  Length:1308        Length:1308        Length:1308                     
##  Class :character   Class :character   Class :character                
##  Mode  :character   Mode  :character   Mode  :character                
##                                                                        
##                                                                        
##                                                                        
##                                                                        
##  number_of_relatives_with_stomach_cancer relative_family_cancer_history
##  Min.   :0.0000                          Length:1308                   
##  1st Qu.:0.0000                          Class :character              
##  Median :0.0000                          Mode  :character              
##  Mean   :0.2632                                                        
##  3rd Qu.:0.0000                                                        
##  Max.   :2.0000                                                        
##  NA's   :1232                                                          
##  cancer_first_degree_relative blood_relative_cancer_history_list
##  Min.   :1.000                Length:1308                       
##  1st Qu.:1.000                Class :character                  
##  Median :1.000                Mode  :character                  
##  Mean   :1.696                                                  
##  3rd Qu.:2.000                                                  
##  Max.   :4.000                                                  
##  NA's   :1285                                                   
##  history_hepato_carcinoma_risk_factors post_op_ablation_embolization_tx
##  Length:1308                           Length:1308                     
##  Class :character                      Class :character                
##  Mode  :character                      Mode  :character                
##                                                                        
##                                                                        
##                                                                        
##                                                                        
##  eastern_cancer_oncology_group primary_pathology_tumor_tissue_site
##  Min.   :0.0000                Length:1308                        
##  1st Qu.:0.0000                Class :character                   
##  Median :0.0000                Mode  :character                   
##  Mean   :0.3514                                                   
##  3rd Qu.:1.0000                                                   
##  Max.   :3.0000                                                   
##  NA's   :1271                                                     
##  primary_pathology_histological_type
##  Length:1308                        
##  Class :character                   
##  Mode  :character                   
##                                     
##                                     
##                                     
##                                     
##  primary_pathology_specimen_collection_method_name
##  Length:1308                                      
##  Class :character                                 
##  Mode  :character                                 
##                                                   
##                                                   
##                                                   
##                                                   
##  primary_pathology_history_prior_surgery_type_other
##  Length:1308                                       
##  Class :character                                  
##  Mode  :character                                  
##                                                    
##                                                    
##                                                    
##                                                    
##  primary_pathology_days_to_initial_pathologic_diagnosis
##  Min.   :0                                             
##  1st Qu.:0                                             
##  Median :0                                             
##  Mean   :0                                             
##  3rd Qu.:0                                             
##  Max.   :0                                             
##  NA's   :1260                                          
##  primary_pathology_age_at_initial_pathologic_diagnosis
##  Min.   :29.00                                        
##  1st Qu.:58.00                                        
##  Median :66.00                                        
##  Mean   :63.64                                        
##  3rd Qu.:73.00                                        
##  Max.   :82.00                                        
##  NA's   :1263                                         
##  primary_pathology_year_of_initial_pathologic_diagnosis
##  Min.   :2005                                          
##  1st Qu.:2010                                          
##  Median :2011                                          
##  Mean   :2011                                          
##  3rd Qu.:2012                                          
##  Max.   :2013                                          
##  NA's   :1260                                          
##  primary_pathology_neoplasm_histologic_grade primary_pathology_residual_tumor
##  Length:1308                                 Length:1308                     
##  Class :character                            Class :character                
##  Mode  :character                            Mode  :character                
##                                                                              
##                                                                              
##                                                                              
##                                                                              
##  primary_pathology_vascular_tumor_cell_type
##  Length:1308                               
##  Class :character                          
##  Mode  :character                          
##                                            
##                                            
##                                            
##                                            
##  primary_pathology_perineural_invasion_present
##  Length:1308                                  
##  Class :character                             
##  Mode  :character                             
##                                               
##                                               
##                                               
##                                               
##  primary_pathology_child_pugh_classification_grade
##  Length:1308                                      
##  Class :character                                 
##  Mode  :character                                 
##                                                   
##                                                   
##                                                   
##                                                   
##  primary_pathology_ca_19_9_level primary_pathology_ca_19_9_level_lower
##  Min.   :   1.0                  Min.   :0.0000                       
##  1st Qu.:  26.5                  1st Qu.:0.0000                       
##  Median :  54.9                  Median :0.0000                       
##  Mean   : 345.8                  Mean   :0.1351                       
##  3rd Qu.: 200.0                  3rd Qu.:0.0000                       
##  Max.   :6910.0                  Max.   :5.0000                       
##  NA's   :1268                    NA's   :1271                         
##  primary_pathology_ca_19_9_level_upper
##  Min.   : 7.00                        
##  1st Qu.:35.00                        
##  Median :55.00                        
##  Mean   :45.56                        
##  3rd Qu.:55.00                        
##  Max.   :55.00                        
##  NA's   :1267                         
##  primary_pathology_fetoprotein_outcome_value
##  Min.   : 1.380                             
##  1st Qu.: 2.350                             
##  Median : 3.100                             
##  Mean   : 3.803                             
##  3rd Qu.: 4.325                             
##  Max.   :14.000                             
##  NA's   :1280                               
##  primary_pathology_fetoprotein_outcome_lower_limit
##  Min.   :0                                        
##  1st Qu.:0                                        
##  Median :0                                        
##  Mean   :0                                        
##  3rd Qu.:0                                        
##  Max.   :0                                        
##  NA's   :1275                                     
##  primary_pathology_fetoprotein_outcome_upper_limit
##  Min.   : 6.000                                   
##  1st Qu.: 6.000                                   
##  Median : 6.000                                   
##  Mean   : 7.579                                   
##  3rd Qu.: 9.000                                   
##  Max.   :15.000                                   
##  NA's   :1275                                     
##  primary_pathology_platelet_result_count
##  Min.   :   134.0                       
##  1st Qu.:   211.0                       
##  Median :   269.5                       
##  Mean   : 68013.6                       
##  3rd Qu.:179500.0                       
##  Max.   :354000.0                       
##  NA's   :1264                           
##  primary_pathology_platelet_result_lower_limit
##  Min.   :   140                               
##  1st Qu.:   150                               
##  Median :   150                               
##  Mean   : 32560                               
##  3rd Qu.: 15000                               
##  Max.   :150000                               
##  NA's   :1263                                 
##  primary_pathology_platelet_result_upper_limit
##  Min.   :   400                               
##  1st Qu.:   450                               
##  Median :   450                               
##  Mean   :126091                               
##  3rd Qu.:400000                               
##  Max.   :450000                               
##  NA's   :1263                                 
##  primary_pathology_prothrombin_time_result_value
##  Min.   : 0.800                                 
##  1st Qu.: 1.000                                 
##  Median : 1.100                                 
##  Mean   : 2.012                                 
##  3rd Qu.: 1.100                                 
##  Max.   :12.200                                 
##  NA's   :1266                                   
##  primary_pathology_inter_norm_ratio_lower_limit
##  Min.   : 0.000                                
##  1st Qu.: 0.800                                
##  Median : 0.900                                
##  Mean   : 1.865                                
##  3rd Qu.: 0.900                                
##  Max.   :10.400                                
##  NA's   :1274                                  
##  primary_pathology_intern_norm_ratio_upper_limit
##  Min.   : 1.100                                 
##  1st Qu.: 1.200                                 
##  Median : 1.200                                 
##  Mean   : 2.553                                 
##  3rd Qu.: 1.200                                 
##  Max.   :13.100                                 
##  NA's   :1274                                   
##  primary_pathology_albumin_result_specified_value
##  Min.   :2.400                                   
##  1st Qu.:3.775                                   
##  Median :4.150                                   
##  Mean   :3.998                                   
##  3rd Qu.:4.325                                   
##  Max.   :4.800                                   
##  NA's   :1268                                    
##  primary_pathology_albumin_result_lower_limit
##  Min.   :3.300                               
##  1st Qu.:3.500                               
##  Median :3.500                               
##  Mean   :3.467                               
##  3rd Qu.:3.500                               
##  Max.   :3.500                               
##  NA's   :1268                                
##  primary_pathology_albumin_result_upper_limit
##  Min.   :4.50                                
##  1st Qu.:4.80                                
##  Median :5.00                                
##  Mean   :4.91                                
##  3rd Qu.:5.00                                
##  Max.   :5.20                                
##  NA's   :1268                                
##  primary_pathology_bilirubin_upper_limit
##  Min.   : 0.200                         
##  1st Qu.: 0.400                         
##  Median : 0.700                         
##  Mean   : 2.859                         
##  3rd Qu.: 1.025                         
##  Max.   :84.000                         
##  NA's   :1264                           
##  primary_pathology_bilirubin_lower_limit
##  Min.   : 0.000                         
##  1st Qu.: 0.100                         
##  Median : 0.100                         
##  Mean   : 2.221                         
##  3rd Qu.: 0.150                         
##  Max.   :78.000                         
##  NA's   :1265                           
##  primary_pathology_total_bilirubin_upper_limit
##  Min.   : 0.300                               
##  1st Qu.: 1.000                               
##  Median : 1.000                               
##  Mean   : 5.505                               
##  3rd Qu.: 1.200                               
##  Max.   :96.000                               
##  NA's   :1265                                 
##  primary_pathology_creatinine_value_in_mg_dl
##  Min.   :0.5000                             
##  1st Qu.:0.8000                             
##  Median :0.9000                             
##  Mean   :0.8651                             
##  3rd Qu.:1.0000                             
##  Max.   :1.4000                             
##  NA's   :1265                               
##  primary_pathology_creatinine_lower_level
##  Min.   :0.4000                          
##  1st Qu.:0.6000                          
##  Median :0.6000                          
##  Mean   :0.6349                          
##  3rd Qu.:0.7000                          
##  Max.   :0.9000                          
##  NA's   :1265                            
##  primary_pathology_creatinine_upper_limit
##  Min.   :1.000                           
##  1st Qu.:1.100                           
##  Median :1.100                           
##  Mean   :1.198                           
##  3rd Qu.:1.300                           
##  Max.   :1.400                           
##  NA's   :1265                            
##  primary_pathology_fibrosis_ishak_score
##  Length:1308                           
##  Class :character                      
##  Mode  :character                      
##                                        
##                                        
##                                        
##                                        
##  primary_pathology_cholangitis_tissue_evidence adenocarcinoma_invasion
##  Length:1308                                   Length:1308            
##  Class :character                              Class :character       
##  Mode  :character                              Mode  :character       
##                                                                       
##                                                                       
##                                                                       
##                                                                       
##  histological_type_other  tumor_type        initial_pathologic_diagnosis_method
##  Length:1308             Length:1308        Length:1308                        
##  Class :character        Class :character   Class :character                   
##  Mode  :character        Mode  :character   Mode  :character                   
##                                                                                
##                                                                                
##                                                                                
##                                                                                
##  init_pathology_dx_method_other surgery_performed_type
##  Length:1308                    Length:1308           
##  Class :character               Class :character      
##  Mode  :character               Mode  :character      
##                                                       
##                                                       
##                                                       
##                                                       
##  histologic_grading_tier_category maximum_tumor_dimension
##  Length:1308                      Min.   : 0.300         
##  Class :character                 1st Qu.: 2.925         
##  Mode  :character                 Median : 3.500         
##                                   Mean   : 3.840         
##                                   3rd Qu.: 4.500         
##                                   Max.   :14.000         
##                                   NA's   :1138           
##  source_of_patient_death_reason tobacco_smoking_history
##  Length:1308                    Min.   :1.000          
##  Class :character               1st Qu.:1.000          
##  Mode  :character               Median :2.000          
##                                 Mean   :2.201          
##                                 3rd Qu.:3.000          
##                                 Max.   :5.000          
##                                 NA's   :1159           
##  year_of_tobacco_smoking_onset stopped_smoking_year number_pack_years_smoked
##  Min.   :1948                  Min.   :1952         Min.   : 0.30           
##  1st Qu.:1960                  1st Qu.:1980         1st Qu.:15.00           
##  Median :1971                  Median :1988         Median :25.00           
##  Mean   :1971                  Mean   :1990         Mean   :26.84           
##  3rd Qu.:1982                  3rd Qu.:2004         3rd Qu.:40.00           
##  Max.   :1993                  Max.   :2013         Max.   :75.00           
##  NA's   :1261                  NA's   :1258         NA's   :1251            
##  alcohol_history_documented alcoholic_exposure_category
##  Length:1308                Length:1308                
##  Class :character           Class :character           
##  Mode  :character           Mode  :character           
##                                                        
##                                                        
##                                                        
##                                                        
##  frequency_of_alcohol_consumption amount_of_alcohol_consumption_per_day
##  Min.   :0.500                    Min.   :0.500                        
##  1st Qu.:3.000                    1st Qu.:1.000                        
##  Median :6.500                    Median :1.000                        
##  Mean   :4.812                    Mean   :1.581                        
##  3rd Qu.:7.000                    3rd Qu.:2.000                        
##  Max.   :7.000                    Max.   :4.000                        
##  NA's   :1276                     NA's   :1277                         
##  history_of_diabetes days_to_diabetes_onset history_of_chronic_pancreatitis
##  Length:1308         Min.   :-9070.00       Length:1308                    
##  Class :character    1st Qu.: -163.00       Class :character               
##  Mode  :character    Median :  -52.00       Mode  :character               
##                      Mean   : -706.79                                      
##                      3rd Qu.:  -17.75                                      
##                      Max.   :  504.00                                      
##                      NA's   :1294                                          
##  days_to_pancreatitis_onset family_history_of_cancer relative_cancer_types
##  Min.   :-18029.0           Length:1308              Length:1308          
##  1st Qu.:  -231.5           Class :character         Class :character     
##  Median :   -71.0           Mode  :character         Mode  :character     
##  Mean   : -1744.2                                                         
##  3rd Qu.:   -38.0                                                         
##  Max.   :     1.0                                                         
##  NA's   :1297                                                             
##  history_prior_surgery_type_other
##  Length:1308                     
##  Class :character                
##  Mode  :character                
##                                  
##                                  
##                                  
##
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Verificar valores nulos</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df_TCGA</span><span class="p">)))</span>
</code></pre></div>
<pre><code>## 
##  FALSE   TRUE 
##  66141 135291
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Verificar valores nulos por columnas</span>
<span class="c1"># print(colSums(is.na(df_TCGA)))</span>

<span class="c1"># Verificar valores nulos por filas</span>
<span class="c1"># print(rowSums(is.na(df_TCGA)))</span>
</code></pre></div>
<p>Let's identify the column that could serve as the main record ID of the dataset. </p>
<div class="highlight"><pre><span></span><code><span class="c1"># Visualizar los primeros 5 elementos de las siguientes columnas tipo ID</span>
<span class="nf">head</span><span class="p">(</span><span class="n">df_TCGA</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;bcr_patient_barcode&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bcr_patient_uuid&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;patient_id&quot;</span><span class="p">)],</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
</code></pre></div>
<pre><code>##   bcr_patient_barcode                     bcr_patient_uuid patient_id
## 1        TCGA-3L-AA1B A94E1279-A975-480A-93E9-7B1FF05CBCBF       AA1B
## 2        TCGA-4N-A93T 92554413-9EBC-4354-8E1B-9682F3A031D9       A93T
## 3        TCGA-4T-AA8H A5E14ADD-1552-4606-9FFE-3A03BCF76640       AA8H
## 4        TCGA-5M-AAT4 1136DD50-242A-4659-AAD4-C53F9E759BB3       AAT4
## 5        TCGA-5M-AAT6 CE00896A-F7D2-4123-BB95-24CB6E53FC32       AAT6
</code></pre>
<p>We observed three different identifiers: the full TCGA barcode, UUID (Universal Unique Identifier), and internal patient code, respectively. In this project, we will use the first one, as it is the standard patient-level identifier in TCGA. We also observed that it contains the internal patient code.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Crear un subconjunto del dataset TCGA con variables relevantes desde una perspectiva oncologica</span>
<span class="n">df_gastro</span><span class="w"> </span><span class="o">&lt;-</span><span class="nf">subset</span><span class="p">(</span><span class="n">df_TCGA</span><span class="p">,</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">bcr_patient_barcode</span><span class="p">,</span><span class="w"> </span><span class="n">tumor_tissue_site</span><span class="p">,</span><span class="w"> </span><span class="n">histological_type</span><span class="p">,</span>
<span class="w">                               </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">vital_status</span><span class="p">,</span><span class="w"> </span><span class="n">days_to_death</span><span class="p">,</span><span class="w"> </span><span class="n">days_to_last_followup</span><span class="p">,</span>
<span class="w">                               </span><span class="n">tissue_source_site</span><span class="p">,</span>
<span class="w">                               </span><span class="n">age_at_initial_pathologic_diagnosis</span><span class="p">,</span><span class="w"> </span><span class="n">person_neoplasm_cancer_status</span><span class="p">,</span>
<span class="w">                               </span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="n">residual_tumor</span><span class="p">,</span><span class="w"> </span><span class="n">anatomic_neoplasm_subdivision</span><span class="p">,</span>
<span class="w">                               </span><span class="n">number_of_lymphnodes_positive_by_he</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_lymphnodes_positive_by_ihc</span><span class="p">,</span>
<span class="w">                               </span><span class="n">preoperative_pretreatment_cea_level</span><span class="p">,</span><span class="w"> </span><span class="n">non_nodal_tumor_deposits</span><span class="p">,</span>
<span class="w">                               </span><span class="n">circumferential_resection_margin</span><span class="p">,</span><span class="w"> </span><span class="n">venous_invasion</span><span class="p">,</span><span class="w"> </span><span class="n">lymphatic_invasion</span><span class="p">,</span>
<span class="w">                               </span><span class="n">perineural_invasion_present</span><span class="p">,</span><span class="w"> </span><span class="n">microsatellite_instability</span><span class="p">,</span>
<span class="w">                               </span><span class="n">number_of_loci_tested</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_abnormal_loci</span><span class="p">,</span><span class="w"> </span><span class="n">kras_gene_analysis_performed</span><span class="p">,</span>
<span class="w">                               </span><span class="n">kras_mutation_found</span><span class="p">,</span><span class="w"> </span><span class="n">kras_mutation_codon</span><span class="p">,</span><span class="w"> </span><span class="n">braf_gene_analysis_performed</span><span class="p">,</span>
<span class="w">                               </span><span class="n">braf_gene_analysis_result</span><span class="p">,</span><span class="w"> </span><span class="n">synchronous_colon_cancer_present</span><span class="p">,</span>
<span class="w">                               </span><span class="n">stage_event_pathologic_stage</span><span class="p">,</span><span class="w"> </span><span class="n">stage_event_tnm_categories</span><span class="p">,</span><span class="w"> </span><span class="n">cancer_type</span><span class="p">))</span>
</code></pre></div>
<p>We then visualized in more detail the customized TCGA dataset with the 34 variables of interest.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Usar función skimr()</span>
<span class="nf">skim</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">)</span>
</code></pre></div>
<pre><code>## Warning: There was 1 warning in `dplyr::summarize()`.
## ℹ In argument: `dplyr::across(tidyselect::any_of(variable_names),
##   mangled_skimmers$funs)`.
## ℹ In group 0: .
## Caused by warning:
## ! There was 1 warning in `dplyr::summarize()`.
## ℹ In argument: `dplyr::across(tidyselect::any_of(variable_names),
##   mangled_skimmers$funs)`.
## Caused by warning in `inline_hist()`:
## ! Variable contains Inf or -Inf value(s) that were converted to NA.
</code></pre>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df_gastro</td>
</tr>
<tr>
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">1308</td>
</tr>
<tr>
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">34</td>
</tr>
<tr>
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">character</td>
<td style="text-align: left;">22</td>
</tr>
<tr>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">12</td>
</tr>
<tr>
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p>Data summary</p>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bcr_patient_barcode</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1307</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">tumor_tissue_site</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">histological_type</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">vital_status</td>
<td style="text-align: right;">636</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">tissue_source_site</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">person_neoplasm_cancer_status</td>
<td style="text-align: right;">194</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">residual_tumor</td>
<td style="text-align: right;">142</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">anatomic_neoplasm_subdivision</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">non_nodal_tumor_deposits</td>
<td style="text-align: right;">1010</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">venous_invasion</td>
<td style="text-align: right;">762</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">lymphatic_invasion</td>
<td style="text-align: right;">740</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">perineural_invasion_present</td>
<td style="text-align: right;">1030</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">microsatellite_instability</td>
<td style="text-align: right;">1190</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">kras_gene_analysis_performed</td>
<td style="text-align: right;">733</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">kras_mutation_found</td>
<td style="text-align: right;">1245</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">braf_gene_analysis_performed</td>
<td style="text-align: right;">747</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">braf_gene_analysis_result</td>
<td style="text-align: right;">1272</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">synchronous_colon_cancer_present</td>
<td style="text-align: right;">744</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">stage_event_pathologic_stage</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">stage_event_tnm_categories</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: left;">cancer_type</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">days_to_death</td>
<td style="text-align: right;">1071</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">503.46</td>
<td style="text-align: right;">524.96</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">145.0</td>
<td style="text-align: right;">366.00</td>
<td style="text-align: right;">641.00</td>
<td style="text-align: right;">3042.0</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr>
<td style="text-align: left;">days_to_last_followup</td>
<td style="text-align: right;">205</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">-Inf</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: right;">-Inf</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">485.00</td>
<td style="text-align: right;">942.00</td>
<td style="text-align: right;">4502.0</td>
<td style="text-align: left;">▇▃▁▁▁</td>
</tr>
<tr>
<td style="text-align: left;">age_at_initial_pathologic_diagnosis</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">65.85</td>
<td style="text-align: right;">11.88</td>
<td style="text-align: right;">30.0</td>
<td style="text-align: right;">58.0</td>
<td style="text-align: right;">67.00</td>
<td style="text-align: right;">74.00</td>
<td style="text-align: right;">90.0</td>
<td style="text-align: left;">▁▃▆▇▃</td>
</tr>
<tr>
<td style="text-align: left;">weight</td>
<td style="text-align: right;">936</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">80.44</td>
<td style="text-align: right;">20.88</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">78.05</td>
<td style="text-align: right;">91.85</td>
<td style="text-align: right;">175.3</td>
<td style="text-align: left;">▃▇▃▁▁</td>
</tr>
<tr>
<td style="text-align: left;">height</td>
<td style="text-align: right;">957</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">168.87</td>
<td style="text-align: right;">11.64</td>
<td style="text-align: right;">80.3</td>
<td style="text-align: right;">162.0</td>
<td style="text-align: right;">170.00</td>
<td style="text-align: right;">176.00</td>
<td style="text-align: right;">193.0</td>
<td style="text-align: left;">▁▁▁▇▆</td>
</tr>
<tr>
<td style="text-align: left;">number_of_lymphnodes_positive_by_he</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">3.49</td>
<td style="text-align: right;">6.26</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">57.0</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr>
<td style="text-align: left;">number_of_lymphnodes_positive_by_ihc</td>
<td style="text-align: right;">1188</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">1.64</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr>
<td style="text-align: left;">preoperative_pretreatment_cea_level</td>
<td style="text-align: right;">906</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">65.07</td>
<td style="text-align: right;">468.84</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">8.98</td>
<td style="text-align: right;">7868.0</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr>
<td style="text-align: left;">circumferential_resection_margin</td>
<td style="text-align: right;">1185</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">22.96</td>
<td style="text-align: right;">28.31</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">13.00</td>
<td style="text-align: right;">30.00</td>
<td style="text-align: right;">165.0</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr>
<td style="text-align: left;">number_of_loci_tested</td>
<td style="text-align: right;">1236</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">4.94</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: left;">▁▁▇▁▁</td>
</tr>
<tr>
<td style="text-align: left;">number_of_abnormal_loci</td>
<td style="text-align: right;">1237</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr>
<td style="text-align: left;">kras_mutation_codon</td>
<td style="text-align: right;">1278</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">13.83</td>
<td style="text-align: right;">8.92</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">61.0</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># Obtener el número de variables y sus nombres</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>
<pre><code>## [1] 1308   34
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Verificar valores nulos</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">)))</span>
</code></pre></div>
<pre><code>## 
## FALSE  TRUE 
## 23465 21007
</code></pre>
<p><strong>Data Transformation</strong></p>
<p>The first transformation to the dataframe <code>df_gastro</code> consisted in creating a new patient survival variable <code>os_time</code> to identify those who are still alive and those who are not. </p>
<div class="highlight"><pre><span></span><code><span class="c1"># Visualizar algunas variables relacionadas a la supervivencia de pacientes</span>
<span class="n">df_gastro</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;vital_status&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;days_to_last_followup&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;days_to_death&quot;</span><span class="p">)]</span>
</code></pre></div>
<pre><code>##    vital_status days_to_last_followup days_to_death
## 1          &lt;NA&gt;                   475            NA
## 2          &lt;NA&gt;                   146            NA
## 3          &lt;NA&gt;                   385            NA
## 4          Dead                  -Inf            49
## 5          Dead                  -Inf           290
## 6          &lt;NA&gt;                  1200            NA
## 7          &lt;NA&gt;                   775            NA
## 8          Dead                  1126          1126
## 9          &lt;NA&gt;                  1419            NA
## 10         &lt;NA&gt;                  1331            NA
</code></pre>
<p>where,</p>
<ul>
<li><strong>vital_status</strong>: patient’s vital status at the time of follow-up closure</li>
<li><strong>days_to_last_followup</strong>: number of days from diagnosis to the last clinical contact with the patient</li>
<li><strong>days_to_death</strong>: number of days from diagnosis to death</li>
</ul>
<p>The <code>os_time</code> variable is a combination of <code>days_to_last_followup</code> and <code>days_to_death</code> where NA values of <code>days_to_death</code> are imputed by those in <code>days_to_last_followup</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Crear la variable de supervivencia de pacientes (los que siguen vivos y los que no)</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">os_time</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span>
<span class="w">  </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">days_to_death</span><span class="p">),</span><span class="w"> </span><span class="c1">#si hay un valor que no es nulo en la variable &quot;days_to_death&quot;</span>
<span class="w">  </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">days_to_death</span><span class="p">,</span>
<span class="w">  </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">days_to_last_followup</span><span class="w"> </span><span class="c1">#en caso contrario, el valor es lo que aparece en la columna &quot;days_to_last_followup&quot;</span>
<span class="p">)</span>

<span class="c1"># Transformar los valores infinitos de os_time en NA</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">os_time</span><span class="p">[</span><span class="nf">is.infinite</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_time</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
</code></pre></div>
<p>In TCGA clinical data, <code>vital_status</code> is sometimes missing or incorrectly analyzed, but if the patient follow-up data are present, it can be assumed that the patient was alive at their last follow-up. This assumption was used in this project, although a more conservative approach would be to exclude those patients.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Asignar &quot;Alive&quot; a los NAs de vital_status si la variable &quot;days_to_last_followup&quot; tiene un valor valido.</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">vital_status</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">vital_status</span><span class="p">)</span><span class="w"> </span>
<span class="w">                    </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">days_to_last_followup</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Alive&quot;</span><span class="w">  </span>

<span class="c1"># Definir os_event, si el paciente está vivo con 0, caso contrario con 1. </span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">os_event</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">vital_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Dead&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span>

<span class="c1"># Eliminar la especificación TCGA del tipo de cáncer para simplificar.</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">cancer_type</span><span class="w"> </span><span class="o">&lt;-</span><span class="nf">gsub</span><span class="p">(</span><span class="s">&quot;TCGA-&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">cancer_type</span><span class="p">)</span><span class="w"> </span><span class="c1">#ref. The R book page 124</span>

<span class="c1"># Eliminar la especificación Stage para simplificar.</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">stage_event_pathologic_stage</span><span class="w"> </span><span class="o">&lt;-</span><span class="nf">gsub</span><span class="p">(</span><span class="s">&quot;Stage &quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">stage_event_pathologic_stage</span><span class="p">)</span><span class="w"> </span><span class="c1">#ref. The R book page 124</span>

<span class="c1"># Estructura del conjunto de datos y resumen estadístico</span>
<span class="nf">str</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">)</span>
</code></pre></div>
<pre><code>## 'data.frame':    1308 obs. of  36 variables:
##  $ bcr_patient_barcode                 : chr  "TCGA-3L-AA1B" "TCGA-4N-A93T" "TCGA-4T-AA8H" "TCGA-5M-AAT4" ...
##  $ tumor_tissue_site                   : chr  "Colon" "Colon" "Colon" "Colon" ...
##  $ histological_type                   : chr  "Colon Adenocarcinoma" "Colon Adenocarcinoma" "Colon Mucinous Adenocarcinoma" "Colon Adenocarcinoma" ...
##  $ gender                              : chr  "FEMALE" "MALE" "FEMALE" "MALE" ...
##  $ vital_status                        : chr  "Alive" "Alive" "Alive" "Dead" ...
##  $ days_to_death                       : int  NA NA NA 49 290 NA NA 1126 NA NA ...
##  $ days_to_last_followup               : num  475 146 385 -Inf -Inf ...
##  $ tissue_source_site                  : chr  "3L" "4N" "4T" "5M" ...
##  $ age_at_initial_pathologic_diagnosis : int  61 67 42 74 40 76 45 85 82 71 ...
##  $ person_neoplasm_cancer_status       : chr  "TUMOR FREE" "WITH TUMOR" "TUMOR FREE" "WITH TUMOR" ...
##  $ weight                              : num  63.3 134 108 NA 99.1 ...
##  $ height                              : num  173 168 168 NA 162 ...
##  $ residual_tumor                      : chr  "R0" "R0" "R0" "R0" ...
##  $ anatomic_neoplasm_subdivision       : chr  "Cecum" "Ascending Colon" "Descending Colon" "Ascending Colon" ...
##  $ number_of_lymphnodes_positive_by_he : int  0 NA 0 0 10 0 NA 3 1 7 ...
##  $ number_of_lymphnodes_positive_by_ihc: int  0 2 NA 0 0 0 NA NA NA 0 ...
##  $ preoperative_pretreatment_cea_level : num  NA 2 NA 550 2.61 2.91 NA 17.4 3.4 32.8 ...
##  $ non_nodal_tumor_deposits            : chr  "NO" "YES" "NO" "NO" ...
##  $ circumferential_resection_margin    : num  NA 30 20 NA NA NA NA NA NA NA ...
##  $ venous_invasion                     : chr  "NO" "NO" "NO" "YES" ...
##  $ lymphatic_invasion                  : chr  "NO" "NO" "NO" NA ...
##  $ perineural_invasion_present         : chr  "NO" "NO" "NO" NA ...
##  $ microsatellite_instability          : chr  "NO" NA "NO" NA ...
##  $ number_of_loci_tested               : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ number_of_abnormal_loci             : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ kras_gene_analysis_performed        : chr  "NO" "NO" "NO" "NO" ...
##  $ kras_mutation_found                 : chr  NA NA NA NA ...
##  $ kras_mutation_codon                 : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ braf_gene_analysis_performed        : chr  "NO" "NO" "NO" "NO" ...
##  $ braf_gene_analysis_result           : chr  NA NA NA NA ...
##  $ synchronous_colon_cancer_present    : chr  "NO" "YES" "NO" "NO" ...
##  $ stage_event_pathologic_stage        : chr  "I" "IIIB" "IIA" "IV" ...
##  $ stage_event_tnm_categories          : chr  "T2N0M0" "T4aN1bM0" "T3N0MX" "T3N0M1b" ...
##  $ cancer_type                         : chr  "COAD" "COAD" "COAD" "COAD" ...
##  $ os_time                             : num  475 146 385 49 290 ...
##  $ os_event                            : num  0 0 0 1 1 0 0 1 0 0 ...
</code></pre>
<h3 id="22-target-questions">2.2 Target Questions</h3>
<ol>
<li>
<p>What is the correlation between the pathological stage of the tumor at diagnosis and survival?</p>
</li>
<li>
<p>What survival differences are observed by patient gender and age?</p>
</li>
<li>
<p>Are there significant differences in survival according to the type of gastrointestinal cancer?</p>
</li>
<li>
<p>What is the impact of venous, lymphatic, or perineural invasion on survival?</p>
</li>
</ol>
<hr />
<h2 id="3-exploratory-data-analysis">3 Exploratory Data Analysis</h2>
<h3 id="31-descriptive-statistics-and-visualization">3.1 Descriptive Statistics and Visualization</h3>
<p>In this section we implement an exploratory and visualization analysis to address the target questions from section 2.2.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Convertir a factor las variables tipo `chr`</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">gender</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">gender</span><span class="p">)</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">residual_tumor</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">residual_tumor</span><span class="p">)</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">venous_invasion</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">venous_invasion</span><span class="p">)</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">lymphatic_invasion</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">lymphatic_invasion</span><span class="p">)</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">perineural_invasion_present</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">perineural_invasion_present</span><span class="p">)</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">microsatellite_instability</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">microsatellite_instability</span><span class="p">)</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">kras_mutation_found</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">kras_mutation_found</span><span class="p">)</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">stage_event_pathologic_stage</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">stage_event_pathologic_stage</span><span class="p">)</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">cancer_type</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">cancer_type</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Visualizar la distribucion de edades en los distintos tipos de cancer</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">subset</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">age_at_initial_pathologic_diagnosis</span><span class="p">)),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cancer_type</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age_at_initial_pathologic_diagnosis</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cancer_type</span><span class="p">))</span><span class="o">+</span><span class="w">  </span>
<span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;black&#39;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Edad Paciente al Momento del Diagnóstico&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="s">&quot;Tipo de Cáncer&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Edad (años)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_fill_brewer</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s">&quot;PRGn&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&#39;Darkblue&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-10-1.png"
style="width:100.0%" height="500"/>
</figure>

<h4 id="question-1-what-is-the-correlation-between-the-pathological-stage-of-the-tumor-at-diagnosis-and-survival">Question 1: What is the correlation between the pathological stage of the tumor at diagnosis and survival?</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Correlacion entre el estadio tumoral y la supervivencia de los pacientes</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">subset</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">stage_event_pathologic_stage</span><span class="p">)),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stage_event_pathologic_stage</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stage_event_pathologic_stage</span><span class="p">))</span><span class="o">+</span><span class="w">  </span>
<span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;black&#39;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia en función del Estadio Tumoral&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="s">&quot;Estadio Tumoral&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia (días)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span><span class="o">+</span>
<span class="w">  </span><span class="c1">#scale_fill_brewer(palette=&quot;PRGn&quot;)+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&#39;Darkblue&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span>
</code></pre></div>
<pre><code>## Warning: Removed 225 rows containing non-finite outside the scale range
## (`stat_boxplot()`).
</code></pre>
<figure>
<img
src="../images/unnamed-chunk-11-1.png"
style="width:100.0%" height="500"/>
</figure>

<p>The survival plot as a function of tumor stage shows that survival progressively decreases as tumor stage increases, as indicated by Singh et al. (<a href="https://doi.org/10.5114/pg.2024.141834">https://doi.org/10.5114/pg.2024.141834</a>). Hence the critical importance of early diagnosis in cancer patients. To provide stronger statistical support for this observation, a more rigorous analysis using a Cox proportional-hazards model would be needed, which is beyond the scope of this project.</p>
<h4 id="question-2-are-there-significant-differences-in-survival-according-to-the-type-of-gastrointestinal-cancer">Question 2: Are there significant differences in survival according to the type of gastrointestinal cancer?</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Supervivencia en función del tipo de cáncer </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">subset</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">os_time</span><span class="p">)),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cancer_type</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cancer_type</span><span class="p">))</span><span class="o">+</span><span class="w"> </span>
<span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;black&#39;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia en función del tipo de cáncer &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="s">&quot;Tipo Cáncer&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Superviviencia (días)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span><span class="o">+</span>
<span class="w">  </span><span class="c1">#scale_fill_brewer(palette=&quot;RdBu&quot;)+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&#39;Darkblue&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-12-1.png"
style="width:100.0%" height="500"/>
</figure>

<p>The survival plot as a function of cancer type shows that the mean expected survival in PAAD patients is lower than that observed in other cancer types, consistent with the literature on pancreatic ductal adenocarcinoma (PDAC). Singh et al. (<a href="https://doi.org/10.5114/pg.2024.141834">https://doi.org/10.5114/pg.2024.141834</a>) point out that PDAC patients have the worst prognosis, with a five-year survival rate barely reaching 12–13%. In contrast, other gastrointestinal cancers such as colorectal cancer have a more favorable prognosis, partly thanks to early detection programs and the development of more specific and effective therapies.</p>
<p>To identify statistically significant differences between cancer types and patient survival time, we implemented the following tests: ANOVA test, validation of ANOVA residual normality assumptions, Kruskal-Wallis test, and Kaplan-Meier survival analysis.</p>
<h5 id="anova-test">ANOVA Test</h5>
<p>An ANOVA test was implemented assuming normality, then residual normality was checked to analyze whether there are statistically significant differences between cancer types.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Eliminar NAs en variables de interés y crear un nuevo dataframe </span>
<span class="n">df_anova</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_gastro</span><span class="p">[</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_time</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">cancer_type</span><span class="p">),</span><span class="w"> </span><span class="p">]</span>

<span class="c1"># Implementar test ANOVA variables os_time y cancer_type </span>
<span class="n">modelo_anova</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">os_time</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">cancer_type</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_anova</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">modelo_anova</span><span class="p">)</span>
</code></pre></div>
<pre><code>##               Df    Sum Sq Mean Sq F value   Pr(&gt;F)    
## cancer_type    4  17419280 4354820   10.36 3.12e-08 ***
## Residuals   1052 442183622  420327                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre>
<p>From the results, the p-value is 3.12e-08 ($p &lt; 0.05$), indicating that there are significant differences between at least two groups. Furthermore, the F-value is 10.36 (&gt; 1), and the higher this value, the stronger the evidence of significant differences between groups. Since ANOVA is significant, we next identified which groups differ from each other using TukeyHSD post-hoc test.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Aplicar test TukeyHSD</span>
<span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">modelo_anova</span><span class="p">)</span>
</code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = os_time ~ cancer_type, data = df_anova)
## 
## $cancer_type
##                 diff       lwr        upr     p adj
## COAD-CHOL  139.08982 -161.7348  439.91445 0.7137666
## PAAD-CHOL -147.08580 -469.7097  175.53807 0.7244215
## READ-CHOL   89.86958 -235.1946  414.93381 0.9430886
## STAD-CHOL -127.06130 -430.0807  175.95811 0.7820316
## PAAD-COAD -286.17562 -457.6440 -114.70723 0.0000559
## READ-COAD  -49.22024 -225.2373  126.79680 0.9407864
## STAD-COAD -266.15112 -397.0557 -135.24654 0.0000003
## READ-PAAD  236.95538   25.8329  448.07786 0.0188148
## STAD-PAAD   20.02450 -155.2659  195.31487 0.9979407
## STAD-READ -216.93088 -396.6732  -37.18855 0.0089008
</code></pre>
<p>From the <code>TukeyHSD post-hoc test</code> results, the adjusted p-values 0.0000003, 0.0000559, 0.0089008, and 0.0188148 (all &lt; 0.05) show that the greatest significant differences are between groups STAD-COAD, PAAD-COAD, STAD-READ, and READ-PAAD, respectively.</p>
<h5 id="validation-of-model-residual-normality-assumptions">Validation of Model Residual Normality Assumptions</h5>
<p>To validate ANOVA results, we checked the following assumptions: normality of residuals, homoscedasticity, and independence.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Validar test ANOVA</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">modelo_anova</span><span class="p">)</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-15-1.png"
style="width:100.0%" height="500"/>
<img
src="../images/unnamed-chunk-15-2.png"
style="width:100.0%" height="500"/>
<img
src="../images/unnamed-chunk-15-3.png"
style="width:100.0%" height="500"/>
<img
src="../images/unnamed-chunk-15-4.png"
style="width:100.0%" height="500"/>
</figure>

<p><strong>Normality</strong></p>
<p>Observing the Q-Q residuals plot (Quantile-Quantile), we can compare the theoretical quantiles of a normal distribution with the actual residual quantiles. In our case, points tend to align close to the diagonal line, especially in the middle part. However, there is evidence of asymmetry in the right tail where an S-shaped curve appears. This may affect the validity of p-values and post-hoc comparisons.</p>
<p><strong>Homoscedasticity</strong></p>
<p>The homoscedasticity assumption requires that residual variance be constant for all fitted values of the model for each group. From the Scale-Location plot, there is no evident relationship between residuals and fitted values (the mean of each group). The band is almost horizontal and flat. Thus, we can assume homogeneity of variances.</p>
<p>Some ideas for answering this question were taken from the post <strong>ANOVA in R</strong> section <a href="https://statsandr.com/blog/anova-in-r/#another-method-to-test-normality-and-homogeneity">Another method to test normality and homogeneity</a>.</p>
<p><strong>Independence</strong></p>
<p>Since the data are not temporal, we can assume a priori there is no autocorrelation. Independence is assumed by design.</p>
<h5 id="kruskal-wallis-test">Kruskal-Wallis Test</h5>
<p>If we assume that the normality assumption is not met, we can apply the following non-parametric tests: <code>Kruskal-Wallis</code> and <code>Dunn’s post-hoc test</code> to validate our results.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Aplicar test Kruskal-Wallis</span>
<span class="nf">kruskal.test</span><span class="p">(</span><span class="n">os_time</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">cancer_type</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_anova</span><span class="p">)</span>
</code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  os_time by cancer_type
## Kruskal-Wallis chi-squared = 50.438, df = 4, p-value = 2.925e-10
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Aplicar post-hoc test Dunn</span>
<span class="nf">dunn.test</span><span class="p">(</span><span class="n">df_anova</span><span class="o">$</span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">df_anova</span><span class="o">$</span><span class="n">cancer_type</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bonferroni&quot;</span><span class="p">)</span>
</code></pre></div>
<pre><code>##   Kruskal-Wallis rank sum test
## 
## data: x and group
## Kruskal-Wallis chi-squared = 50.4378, df = 4, p-value = 0
## 
## 
##                            Comparison of x by group                            
##                                  (Bonferroni)                                  
## Col Mean-|
## Row Mean |       CHOL       COAD       PAAD       READ
## ---------+--------------------------------------------
##     COAD |  -0.670817
##          |     1.0000
##          |
##     PAAD |   1.809028   4.580635
##          |     0.3522    0.0000*
##          |
##     READ |  -0.718359  -0.180178  -3.870495
##          |     1.0000     1.0000    0.0005*
##          |
##     STAD |   1.892153   5.921548  -0.058624   4.489049
##          |     0.2924    0.0000*     1.0000    0.0000*
## 
## alpha = 0.05
## Reject Ho if p &lt;= alpha/2
</code></pre>
<p>The non-parametric tests confirmed that the following groups have statistically significant differences: PAAD-COAD, READ-PAAD, STAD-COAD, and STAD-READ.</p>
<h5 id="kaplan-meier-survival-studies">Kaplan-Meier Survival Studies</h5>
<div class="highlight"><pre><span></span><code><span class="c1"># Implementar Kaplan-Meier por tipo de cancer</span>
<span class="c1"># Crear objeto de supervivencia</span>
<span class="n">survival_obj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Surv</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_event</span><span class="p">)</span>

<span class="c1"># Ajustar el model Kaplan-Meier por género</span>
<span class="n">ajuste_cancer_type</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">cancer_type</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;kaplan-meier&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>

<span class="c1"># Para evitar nombres arbitrarios para el tipo de cáncer necesitamos utilizar los nombres de grupo que figuran en los datos</span>
<span class="n">nombres_tipos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">ajuste_cancer_type</span><span class="o">$</span><span class="n">strata</span><span class="p">)</span>

<span class="c1"># Visualizar gráfico</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">ajuste_cancer_type</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Probabilidad&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&#39;Tiempo (días)&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="n">mark.time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="nf">length</span><span class="p">(</span><span class="n">nombres_tipos</span><span class="p">)),</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia en Función del Tipo de Cancer&quot;</span><span class="p">)</span>

<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;bottomleft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nombres_tipos</span><span class="p">,</span>
<span class="w">       </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="nf">length</span><span class="p">(</span><span class="n">nombres_tipos</span><span class="p">)),</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-17-1.png"
style="width:100.0%" height="500"/>
</figure>

<div class="highlight"><pre><span></span><code><span class="c1"># Comparamos la supervivencia entre categorías de tipo de cancer</span>
<span class="n">comparar_cancer_type</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survdiff</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">cancer_type</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>
<span class="n">comparar_cancer_type</span>
</code></pre></div>
<pre><code>## Call:
## survdiff(formula = survival_obj ~ cancer_type, data = df_gastro)
## 
## n=1057, 251 observations deleted due to missingness.
## 
##                    N Observed Expected (O-E)^2/E (O-E)^2/V
## cancer_type=CHOL  38       20     8.76      14.4     15.01
## cancer_type=COAD 397       57   101.75      19.7     34.75
## cancer_type=PAAD 146       66    28.17      50.8     57.88
## cancer_type=READ 136        9    33.79      18.2     21.23
## cancer_type=STAD 340       87    66.53       6.3      8.79
## 
##  Chisq= 111  on 4 degrees of freedom, p= &lt;2e-16
</code></pre>
<p>Kaplan-Meier survival test results also show significant differences in survival according to cancer type, with a Chi-square value of 111, 4 degrees of freedom, and a p-value below 2e-16.</p>
<p>As previously reported in the literature, patients with pancreatic adenocarcinoma (PAAC) and cholangiocarcinoma have the worst prognoses. In our analysis, we confirmed that patients with pancreatic and biliary tract cancers have a number of deaths clearly higher than expected, reflecting a significantly lower overall survival compared to other tumor types such as colon or rectal cancer.</p>
<h4 id="question-3-what-survival-differences-are-observed-by-patient-gender-and-age">Question 3: What survival differences are observed by patient gender and age?</h4>
<p>Before implementing survival analysis by age, it is recommended to categorize the variable <code>age_at_initial_pathologic_diagnosis</code> ensuring a balanced distribution between groups.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Categorizar la variable age_at_initial_pathologic_diagnosis</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">age_category</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">age_at_initial_pathologic_diagnosis</span><span class="p">,</span>
<span class="w">                       </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span><span class="m">59</span><span class="p">,</span><span class="m">69</span><span class="p">,</span><span class="m">79</span><span class="p">,</span><span class="kc">Inf</span><span class="p">),</span>
<span class="w">                       </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Personas_60-&quot;</span><span class="p">,</span><span class="s">&quot;Personas_60&quot;</span><span class="p">,</span><span class="s">&quot;Personas_70&quot;</span><span class="p">,</span><span class="s">&quot;Personas_80+&quot;</span><span class="p">),</span>
<span class="w">                       </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1"># Verificar distribución de categorias</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">age_category</span><span class="p">)</span>
</code></pre></div>
<pre><code>## 
## Personas_60-  Personas_60  Personas_70 Personas_80+ 
##          368          363          368          153
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Distribucion de edades de pacientes por género</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">subset</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">age_category</span><span class="p">)),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">age_category</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gender</span><span class="p">))</span><span class="o">+</span><span class="w">   </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dodge&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Distribución de edades de pacientes por género&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">       </span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Edad (años)&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="n">y</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Frecuencia&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&#39;Darkblue&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-20-1.png"
style="width:100.0%" height="500"/>
</figure>

<h5 id="kaplan-meier-survival-studies_1">Kaplan-Meier Survival Studies</h5>
<p>Kaplan-Meier survival studies by patient gender and age are shown below. For implementation, the following resources were consulted: <a href="https://ocbe-uio.github.io/survomics/survomics.html#survival-analysis-with-low-dimensional-input-data">Survival
analysis with low-dimensional input
data</a>,
<a href="https://www.costalab.org/wp-content/uploads/2020/11/R_class_D3.html#5_Survival_Analysis">Analysis of Cancer Genome Atlas in
R</a>
and <a href="https://learning.oreilly.com/library/view/the-r-book/9781119634324/c15.xhtml#head-2-134">The R Book, 3rd Edition by Elinor Jones, Simon Harden, Michael J.
Crawley, cap. 15 Survial
Analysis</a>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Implementar Kaplan-Meier por género </span>
<span class="c1"># Crear objeto de supervivencia</span>
<span class="n">survival_obj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Surv</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_event</span><span class="p">)</span>

<span class="c1"># Ajustar el model Kaplan-Meier por género</span>
<span class="n">ajuste_genero</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;kaplan-meier&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>

<span class="c1"># Visualizar gráfico</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">ajuste_genero</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Probabilidad&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&#39;Tiempo (días)&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="n">mark.time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia en Función del Género&quot;</span><span class="p">)</span>

<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;bottomleft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Female&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Male&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-21-1.png"
style="width:100.0%" height="500"/>
</figure>

<div class="highlight"><pre><span></span><code><span class="c1"># Comparamos la supervivencia entre géneros</span>
<span class="n">comparar_generos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survdiff</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>
<span class="n">comparar_generos</span>
</code></pre></div>
<pre><code>## Call:
## survdiff(formula = survival_obj ~ gender, data = df_gastro)
## 
## n=1057, 251 observations deleted due to missingness.
## 
##                 N Observed Expected (O-E)^2/E (O-E)^2/V
## gender=FEMALE 433       86      102      2.54      4.44
## gender=MALE   624      153      137      1.89      4.44
## 
##  Chisq= 4.4  on 1 degrees of freedom, p= 0.04
</code></pre>
<p>Regarding survival and gender, in the Kaplan-Meier plot, the curve for women reaches a stable value of approximately 0.65 at 1,800 days, indicating that about 65% survive beyond that time. In contrast, the men’s curve shows a longer decline, stabilizing at different points, then dropping to about 0.35 at 3,000 days. This implies that only 35% of men reach that survival time threshold. The log-rank test (Chi² = 4.4, p = 0.04) supports this visual inspection, where the observed differences are statistically significant. Women have fewer events (deaths) than expected, suggesting better clinical outcomes compared to men.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Implementar Kaplan-Meier por edad</span>
<span class="c1"># Ajustar el model Kaplan-Meier por edad</span>
<span class="n">ajuste_edad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">age_category</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;kaplan-meier&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>

<span class="c1"># Visualizar gráfico</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">ajuste_edad</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Probabilidad&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&#39;Tiempo (días)&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="n">mark.time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">4</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Superviviencia en Función de la Edad&quot;</span><span class="p">)</span>

<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;bottomleft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Personas_60-&quot;</span><span class="p">,</span><span class="s">&quot;Personas_60&quot;</span><span class="p">,</span><span class="s">&quot;Personas_70&quot;</span><span class="p">,</span><span class="s">&quot;Personas_80+&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">4</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-23-1.png"
style="width:100.0%" height="500"/>
</figure>

<div class="highlight"><pre><span></span><code><span class="c1"># Comparamos la supervivencia entre categorías de edades</span>
<span class="n">comparar_edades</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survdiff</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">age_category</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>
<span class="n">comparar_edades</span>
</code></pre></div>
<pre><code>## Call:
## survdiff(formula = survival_obj ~ age_category, data = df_gastro)
## 
## n=1016, 292 observations deleted due to missingness.
## 
##                             N Observed Expected (O-E)^2/E (O-E)^2/V
## age_category=Personas_60- 311       51     70.2     5.268     7.789
## age_category=Personas_60  298       58     64.7     0.695     0.989
## age_category=Personas_70  298       78     65.3     2.482     3.540
## age_category=Personas_80+ 109       32     18.8     9.290    10.197
## 
##  Chisq= 17.8  on 3 degrees of freedom, p= 5e-04
</code></pre>
<p>Regarding survival and age, in the Kaplan-Meier plot, younger groups maintain higher and more sustained survival curves over time, while curves for those over 70 and 80 years show a sharper decline. The log-rank test (Chi² = 17.8, df = 3, p = 0.0005) confirms that there are statistically significant differences between age groups. In particular, patients over 80 years have an observed mortality much higher than expected (32 observed vs 18.8 expected). By contrast, patients under 60 have a lower observed mortality than expected (51 vs 70.2), indicating better relative survival.</p>
<h4 id="question-4-what-is-the-impact-of-venous-lymphatic-or-perineural-invasion-on-survival">Question 4: What is the impact of venous, lymphatic, or perineural invasion on survival?</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Reorganizar los datos </span>
<span class="n">df_long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_gastro</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">perineural_invasion_present</span><span class="p">,</span><span class="w"> </span><span class="n">venous_invasion</span><span class="p">,</span><span class="w"> </span><span class="n">lymphatic_invasion</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">pivot_longer</span><span class="p">(</span>
<span class="w">    </span><span class="n">cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">perineural_invasion_present</span><span class="p">,</span><span class="w"> </span><span class="n">venous_invasion</span><span class="p">,</span><span class="w"> </span><span class="n">lymphatic_invasion</span><span class="p">),</span>
<span class="w">    </span><span class="n">names_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tipo_invasion&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">values_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;presencia&quot;</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">presencia</span><span class="p">))</span><span class="w">  </span>

<span class="c1"># Crear el gráfico combinado</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">df_long</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">presencia</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">presencia</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">tipo_invasion</span><span class="p">,</span><span class="w"> </span><span class="n">scales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;free_x&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span>
<span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia según tipo de invasión tumoral&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Presencia de invasión&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia (días)&quot;</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span>
<span class="w">    </span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Darkblue&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;bold&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
</code></pre></div>
<pre><code>## Warning: Removed 195 rows containing non-finite outside the scale range
## (`stat_boxplot()`).
</code></pre>
<figure>
<img
src="../images/unnamed-chunk-25-1.png"
style="width:100.0%" height="500"/>
</figure>

<h5 id="kaplan-meier-survival-studies_2">Kaplan-Meier Survival Studies</h5>
<div class="highlight"><pre><span></span><code><span class="c1"># Implementar Kaplan-Meier invásion venosa</span>
<span class="c1"># Crear objeto de supervivencia</span>
<span class="n">survival_obj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Surv</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_event</span><span class="p">)</span>

<span class="c1"># Ajustar el model Kaplan-Meier por género</span>
<span class="n">ajuste_invasion_venosa</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">venous_invasion</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;kaplan-meier&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>

<span class="c1"># Visualizar gráfico</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">ajuste_invasion_venosa</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Probabilidad&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&#39;Tiempo (días)&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="n">mark.time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia en función de la invásion venosa&quot;</span><span class="p">)</span>

<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;bottomleft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Present&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Absent&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-26-1.png"
style="width:100.0%" height="500"/>
</figure>

<div class="highlight"><pre><span></span><code><span class="c1"># Comparamos la supervivencia entre pacientes con o sin invásion</span>
<span class="n">comparar_invasion_venosa</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survdiff</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">venous_invasion</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>
<span class="n">comparar_invasion_venosa</span>
</code></pre></div>
<pre><code>## Call:
## survdiff(formula = survival_obj ~ venous_invasion, data = df_gastro)
## 
## n=467, 841 observations deleted due to missingness.
## 
##                       N Observed Expected (O-E)^2/E (O-E)^2/V
## venous_invasion=NO  361       29     42.1      4.08        20
## venous_invasion=YES 106       24     10.9     15.77        20
## 
##  Chisq= 20  on 1 degrees of freedom, p= 8e-06
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Implementar Kaplan-Meier invasion perineural</span>
<span class="c1"># Crear objeto de supervivencia</span>
<span class="n">survival_obj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Surv</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_event</span><span class="p">)</span>

<span class="c1"># Ajustar el model Kaplan-Meier por género</span>
<span class="n">ajuste_invasion_perineural</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">perineural_invasion_present</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;kaplan-meier&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>

<span class="c1"># Visualizar gráfico</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">ajuste_invasion_perineural</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Probabilidad&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&#39;Tiempo (días)&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="n">mark.time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia en Función de la Invasión perineural&quot;</span><span class="p">)</span>

<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;bottomleft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Present&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Absent&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-28-1.png"
style="width:100.0%" height="500"/>
</figure>

<div class="highlight"><pre><span></span><code><span class="c1"># Comparamos la supervivencia entre los pacientes con y sin invasión perineural</span>
<span class="n">comparar_invasion_perineural</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survdiff</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">perineural_invasion_present</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>
<span class="n">comparar_invasion_perineural</span>
</code></pre></div>
<pre><code>## Call:
## survdiff(formula = survival_obj ~ perineural_invasion_present, 
##     data = df_gastro)
## 
## n=247, 1061 observations deleted due to missingness.
## 
##                                   N Observed Expected (O-E)^2/E (O-E)^2/V
## perineural_invasion_present=NO  182       25    31.74      1.43      6.43
## perineural_invasion_present=YES  65       16     9.26      4.91      6.43
## 
##  Chisq= 6.4  on 1 degrees of freedom, p= 0.01
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Implementar Kaplan-Meier Invasión linfática</span>
<span class="c1"># Crear objeto de supervivencia</span>
<span class="n">survival_obj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Surv</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_time</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">os_event</span><span class="p">)</span>

<span class="c1"># Ajustar el model Kaplan-Meier por género</span>
<span class="n">ajuste_invasion_linfatica</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survfit</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">lymphatic_invasion</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;kaplan-meier&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>

<span class="c1"># Visualizar gráfico</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">ajuste_invasion_linfatica</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Probabilidad&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&#39;Tiempo (días)&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="n">mark.time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Supervivencia en Función de la Invasión Linfática&quot;</span><span class="p">)</span>

<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;bottomleft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Present&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Absent&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">hue_pal </span><span class="p">()(</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-30-1.png"
style="width:100.0%" height="500"/>
</figure>

<div class="highlight"><pre><span></span><code><span class="c1"># Comparamos la supervivencia entre los pacientes con y sin invasión perineural</span>
<span class="n">comparar_invasion_linfatica</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">survdiff</span><span class="p">(</span><span class="n">survival_obj</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">lymphatic_invasion</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">df_gastro</span><span class="p">)</span>
<span class="n">comparar_invasion_linfatica</span>
</code></pre></div>
<pre><code>## Call:
## survdiff(formula = survival_obj ~ lymphatic_invasion, data = df_gastro)
## 
## n=483, 825 observations deleted due to missingness.
## 
##                          N Observed Expected (O-E)^2/E (O-E)^2/V
## lymphatic_invasion=NO  305       25       36      3.37      10.3
## lymphatic_invasion=YES 178       29       18      6.75      10.3
## 
##  Chisq= 10.3  on 1 degrees of freedom, p= 0.001
</code></pre>
<p>Survival analysis by histopathological variables revealed significant differences associated with venous, lymphatic, and perineural invasion. These three features are known to reflect greater tumor aggressiveness, and our results statistically confirmed this.</p>
<p>First, venous invasion showed a highly significant association with survival (Chi-square = 20, p = 8e-06), with a number of deaths much higher than expected in patients with positive invasion. Similarly, lymphatic invasion was associated with worse prognosis (Chi-square = 10.3, p = 0.001), with higher mortality in the invasion-positive group.</p>
<p>Finally, perineural invasion was significantly associated with reduced survival (Chi-square = 6.4, p = 0.01), although with a smaller cohort size.</p>
<p>These results support the clinical value of these variables as potential negative prognostic markers in gastrointestinal cancer patients. They also highlight the importance of including them in risk stratification and therapeutic decision-making.</p>
<h4 id="question-5-what-is-the-bmi-distribution-of-patients-by-gender">Question 5: What is the BMI distribution of patients by gender?</h4>
<p>BMI (Body Mass Index) is a widely used indicator in oncology to assess metabolic risk, prognosis, and treatment response, according to the IARC Working Group report <a href="https://www.nejm.org/doi/10.1056/NEJMsr1606602?url_ver=Z39.88-2003&amp;rfr_id=ori:rid:crossref.org&amp;rfr_dat=cr_pub%20%200www.ncbi.nlm.nih.gov">Body Fatness and Cancer — Viewpoint of the IARC Working Group</a>. BMI at diagnosis may reflect comorbidities (diabetes, hypertension) that can influence cancer progression. For this reason, we included BMI as a key variable for patient stratification, referencing NIH-proposed categories. For more details, consult <a href="https://www.cancer.gov/espanol/cancer/causas-prevencion/riesgo/obesidad/hoja-informativa-obesidad">Obesity and Cancer</a>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Función para calcular el IMC de un paciente </span>
<span class="n">calcular_imc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">peso</span><span class="p">,</span><span class="w"> </span><span class="n">altura</span><span class="p">){</span>
<span class="w">  </span><span class="n">imc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">peso</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">altura</span><span class="o">/</span><span class="m">100</span><span class="p">)</span><span class="o">^</span><span class="m">2</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="p">(</span><span class="n">imc</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># calcular_imc &lt;- function(peso, altura){</span>
<span class="c1">#   tryCatch(</span>
<span class="c1">#     {</span>
<span class="c1">#       # Convertir en valores numéricos por default</span>
<span class="c1">#       #peso      &lt;- as.numeric(peso)</span>
<span class="c1">#       #altura    &lt;- as.numeric(altura)</span>
<span class="c1">#       </span>
<span class="c1">#       # Validar rango de valores de entrada. </span>
<span class="c1">#       if(altura &lt;= 0.0){</span>
<span class="c1">#         stop(&quot;Error: La variable altura no debe ser negativa o cero&quot;)</span>
<span class="c1">#       }</span>
<span class="c1">#       </span>
<span class="c1">#       imc &lt;- peso / (altura^2)</span>
<span class="c1">#       return(imc)</span>
<span class="c1">#     },</span>
<span class="c1">#     error = function(e){</span>
<span class="c1">#         message(&quot;Error en el cálculo: &quot;, e$message)</span>
<span class="c1">#         return(NA)</span>
<span class="c1">#     }</span>
<span class="c1">#   )</span>
<span class="c1"># }</span>

<span class="c1"># Crear la variable imc_at_initial_pathologic_diagnosis</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">imc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">calcular_imc</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">df_gastro</span><span class="o">$</span><span class="n">height</span><span class="p">)</span>

<span class="c1"># Categorizar la variable imc según las categorías propuestas por NIH</span>
<span class="n">df_gastro</span><span class="o">$</span><span class="n">imc_category</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">imc</span><span class="p">,</span>
<span class="w">                       </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span><span class="m">18.5</span><span class="p">,</span><span class="m">25.0</span><span class="p">,</span><span class="m">30.0</span><span class="p">,</span><span class="kc">Inf</span><span class="p">),</span>
<span class="w">                       </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Bajo_Peso&quot;</span><span class="p">,</span><span class="s">&quot;Normal&quot;</span><span class="p">,</span><span class="s">&quot;Sobrepeso&quot;</span><span class="p">,</span><span class="s">&quot;Obesidad&quot;</span><span class="p">),</span>
<span class="w">                       </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1"># Verificar distribución de categorias</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">imc_category</span><span class="p">)</span>
</code></pre></div>
<pre><code>## 
## Bajo_Peso    Normal Sobrepeso  Obesidad 
##         6       108       138        99
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Distribucion de IMC de pacientes por género</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">subset</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">imc_category</span><span class="p">)),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">imc_category</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gender</span><span class="p">))</span><span class="o">+</span><span class="w">   </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dodge&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Distribución de IMC de pacientes por género&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">       </span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Edad (años)&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="n">y</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Frecuencia&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&#39;Darkblue&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-33-1.png"
style="width:100.0%" height="500"/>
</figure>

<h3 id="32-probability-study">3.2 Probability Study</h3>
<p>This section proposes three probability problems related to the TCGA dataset.</p>
<h4 id="exercise-a">Exercise A</h4>
<p>In the customized TCGA dataset (<code>df_gastro</code>), approximately 14.15% of patients have pancreatic cancer, according to the <code>cancer_type</code> variable. If we take a random sample of 100 patients:</p>
<ul>
<li>
<p>What is the probability that exactly 5 patients have pancreatic cancer?</p>
</li>
<li>
<p>What is the probability that at most 10 patients have pancreatic cancer?</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Verificar distribución de categorias por tipo de cáncer</span>
<span class="n">frecuencias</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">cancer_type</span><span class="p">)</span>
<span class="n">frecuencias</span>
</code></pre></div>
<pre><code>## 
##      CHOL COAD PAAD READ STAD 
##    1   48  459  185  171  443
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Verificar porcentaje de distribución de categorías por tipo de cáncer</span>
<span class="c1"># porcentajes &lt;- prop.table(frecuencias) * 100</span>
<span class="n">porcentajes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">prop.table</span><span class="p">(</span><span class="n">frecuencias</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="n">porcentajes</span>
</code></pre></div>
<pre><code>## 
##        CHOL  COAD  PAAD  READ  STAD 
##  0.08  3.67 35.12 14.15 13.08 33.89
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Describir datos para calcular P(X = 5)</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.1415</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">5</span>

<span class="c1"># Aplicar distribución binomial para P(X = 5)</span>
<span class="n">paciente_5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">dbinom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;La probabilidad de que exactamente 5 pacientes tengan cáncer de páncreas es:&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nf">round</span><span class="p">(</span><span class="n">paciente_5</span><span class="p">,</span><span class="m">4</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="s">&quot;%&quot;</span><span class="p">))</span>
</code></pre></div>
<pre><code>## [1] "La probabilidad de que exactamente 5 pacientes tengan cáncer de páncreas es: 0.22 %"
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Describir datos para calcular P(X &lt;= 10)</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.1415</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">10</span>

<span class="c1"># Aplicar distribución binomial para P(X &lt;= 10)</span>
<span class="n">paciente_10</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">pbinom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;La probabilidad de que un máximo de 10 pacientes tengan cáncer de páncreas es:&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nf">round</span><span class="p">(</span><span class="n">paciente_10</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="s">&quot;%&quot;</span><span class="p">))</span>
</code></pre></div>
<pre><code>## [1] "La probabilidad de que un máximo de 10 pacientes tengan cáncer de páncreas es: 14.62 %"
</code></pre>
<h4 id="exercise-b">Exercise B</h4>
<p>Of the patients with perineural invasion, what is the probability that they have an advanced pathological stage, equal to or greater than type III?</p>
<p>This is a conditional probability problem where we are asked: P(Stage &gt;= III | Perineural Invasion = YES)</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Visualizar variables categóricas de interés</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Distribución de categorías para la variable perineural_invasion_present&quot;</span><span class="p">)</span>
</code></pre></div>
<pre><code>## [1] "Distribución de categorías para la variable perineural_invasion_present"
</code></pre>
<div class="highlight"><pre><span></span><code><span class="nf">table</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">perineural_invasion_present</span><span class="p">)</span>
</code></pre></div>
<pre><code>## 
##      NO YES 
##   1 206  71
</code></pre>
<div class="highlight"><pre><span></span><code><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Distribución de categorías para la variable stage_event_pathologic_stage&quot;</span><span class="p">)</span>
</code></pre></div>
<pre><code>## [1] "Distribución de categorías para la variable stage_event_pathologic_stage"
</code></pre>
<div class="highlight"><pre><span></span><code><span class="nf">table</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">stage_event_pathologic_stage</span><span class="p">)</span>
</code></pre></div>
<pre><code>## 
##         I   IA   IB   II  IIA  IIB  IIC  III IIIA IIIB IIIC   IV  IVA  IVB 
##    1  131   22   56   82  248  193    2   36   94  149   93  115   27    7
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Eliminar NAs en variables de interés y crear un nuevo dataframe </span>
<span class="n">df_estate_peri</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_gastro</span><span class="p">[</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">perineural_invasion_present</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>
<span class="w">                      </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">stage_event_pathologic_stage</span><span class="p">),</span><span class="w"> </span><span class="p">]</span>
</code></pre></div>
<p>To study the relationship between categorical variable groups, the next step is to build a 14 x 2 contingency table, showing counts for each invasion_perineural–stage combination, resulting in 28 observed frequencies.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Crear tabla de contingencia </span>
<span class="n">tabla_conti</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="n">df_estate_peri</span><span class="o">$</span><span class="n">perineural_invasion_present</span><span class="p">,</span>
<span class="w">               </span><span class="n">df_estate_peri</span><span class="o">$</span><span class="n">stage_event_pathologic_stage</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Tabla de contingencia de variables categóricas&quot;</span><span class="p">)</span>
</code></pre></div>
<pre><code>## [1] "Tabla de contingencia de variables categóricas"
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">tabla_conti</span>
</code></pre></div>
<pre><code>##      
##           I IA IB II IIA IIB IIC III IIIA IIIB IIIC IV IVA IVB
##        1  0  0  0  0   0   0   0   0    0    0    0  0   0   0
##   NO   0 53  1  0  9  52   4   1   7    9   31   14  6  10   4
##   YES  0  8  0  0  4  13   5   0   1    0   13    4 10   6   3
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Calcular proporciones para cada grupo de pacientes con invasión perineural </span>
<span class="n">prop_conti</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">prop.table</span><span class="p">(</span><span class="n">tabla_conti</span><span class="p">,</span><span class="w"> </span><span class="n">margin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># margin = 1 obtiene proporciones por fila</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Tabla de proporciones&quot;</span><span class="p">)</span>
</code></pre></div>
<pre><code>## [1] "Tabla de proporciones"
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">prop_conti</span>
</code></pre></div>
<pre><code>##      
##                             I          IA          IB          II         IIA
##       1.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
##   NO  0.000000000 0.263681592 0.004975124 0.000000000 0.044776119 0.258706468
##   YES 0.000000000 0.119402985 0.000000000 0.000000000 0.059701493 0.194029851
##      
##               IIB         IIC         III        IIIA        IIIB        IIIC
##       0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
##   NO  0.019900498 0.004975124 0.034825871 0.044776119 0.154228856 0.069651741
##   YES 0.074626866 0.000000000 0.014925373 0.000000000 0.194029851 0.059701493
##      
##                IV         IVA         IVB
##       0.000000000 0.000000000 0.000000000
##   NO  0.029850746 0.049751244 0.019900498
##   YES 0.149253731 0.089552239 0.044776119
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Obtener la proporción solo para el grupo con invasión perineural = &#39;YES&#39; y estadios &gt; III</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Tabla de proporciones para pacientes con invasión perineural = &#39;YES&#39; y estadios &gt; III&quot;</span><span class="p">)</span>
</code></pre></div>
<pre><code>## [1] "Tabla de proporciones para pacientes con invasión perineural = 'YES' y estadios &gt; III"
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">prop_conti</span><span class="p">[</span><span class="s">&quot;YES&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;III&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IIIA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IIIB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IIIC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IV&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IVA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IVB&quot;</span><span class="p">)]</span>
</code></pre></div>
<pre><code>##        III       IIIA       IIIB       IIIC         IV        IVA        IVB 
## 0.01492537 0.00000000 0.19402985 0.05970149 0.14925373 0.08955224 0.04477612
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Obtener la probabilidad total conjunta</span>
<span class="n">prob_conjunta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">prop_conti</span><span class="p">[</span><span class="s">&quot;YES&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;III&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IIIA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IIIB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IIIC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IV&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IVA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IVB&quot;</span><span class="p">)])</span>
<span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Probabilidad estadio igual o superior a tipo III:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">prob_conjunta</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="s">&quot;%&quot;</span><span class="p">)</span>
</code></pre></div>
<pre><code>## [1] "Probabilidad estadio igual o superior a tipo III: 55.22 %"
</code></pre>
<h4 id="exercise-c">Exercise C</h4>
<p>The mean age at diagnosis is 65.85 years with a standard deviation of 11.88 years. Assuming a normal distribution, what is the probability that a patient is between 60 and 70 years old?</p>
<p>In this problem we will use the normal distribution to obtain P(60 &lt; X &lt; 70)</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Describir datos para obtener P(60 &lt; X &lt; 70)</span>
<span class="n">media</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">age_at_initial_pathologic_diagnosis</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">sigma</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">df_gastro</span><span class="o">$</span><span class="n">age_at_initial_pathologic_diagnosis</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">x1</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">60</span>
<span class="n">x2</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">70</span>

<span class="c1"># Aplicar distribución normal para obtener la probabilidad P(60 &lt; X &lt; 70)</span>
<span class="n">menor_a_70</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">media</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">)</span>
<span class="n">menor_a_60</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">media</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">)</span>
<span class="n">entre_70_60</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">menor_a_70</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">menor_a_60</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;La probabilidad de que un paciente tenga entre 60 y 70 años es:&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nf">round</span><span class="p">(</span><span class="n">entre_70_60</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="s">&quot;%&quot;</span><span class="p">))</span>
</code></pre></div>
<pre><code>## [1] "La probabilidad de que un paciente tenga entre 60 y 70 años es: 32.55 %"
</code></pre>
<hr />
<h2 id="4-machine-learning-models">4 Machine Learning Models</h2>
<p>Since our goal is to identify factors associated with cancer patient survival, we opted to apply supervised learning models, as we have a well-defined dependent variable: overall survival (<code>os_event</code>).</p>
<p>We trained a supervised learning model using Support Vector Machine (SVM). For this, we selected a subset of clinical variables including age at diagnosis, gender, residual tumor type, pathological stage, number of positive nodes, cancer type, and presence of venous, lymphatic, or perineural invasion.</p>
<h3 id="41-supervised-model-svm">4.1 Supervised Model (SVM)</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Filtramos filas sin valores NA en variables clave</span>
<span class="n">model_df_supervised</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">na.omit</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;age_at_initial_pathologic_diagnosis&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;gender&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;residual_tumor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;stage_event_pathologic_stage&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;number_of_lymphnodes_positive_by_he&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;cancer_type&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                </span><span class="s">&quot;venous_invasion&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lymphatic_invasion&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;perineural_invasion_present&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;os_event&quot;</span><span class="p">)])</span>

<span class="c1"># Convertimos os_event en factor (para clasificación)</span>
<span class="n">model_df_supervised</span><span class="o">$</span><span class="n">os_event</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">model_df_supervised</span><span class="o">$</span><span class="n">os_event</span><span class="p">)</span>

<span class="c1"># Dividimos el conjunto de datos en entrenamiento y prueba</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">  </span><span class="c1"># Para reproducibilidad</span>
<span class="n">indices_entrenamiento</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">model_df_supervised</span><span class="p">),</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">model_df_supervised</span><span class="p">))</span>
<span class="n">conjunto_entrenamiento</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model_df_supervised</span><span class="p">[</span><span class="n">indices_entrenamiento</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>
<span class="n">conjunto_prueba</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model_df_supervised</span><span class="p">[</span><span class="o">-</span><span class="n">indices_entrenamiento</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>

<span class="c1"># Cargamos el paquete &quot;kernlab&quot; para SVM</span>
<span class="nf">library</span><span class="p">(</span><span class="n">kernlab</span><span class="p">)</span>
</code></pre></div>
<pre><code>## Warning: package 'kernlab' was built under R version 4.4.1

## 
## Attaching package: 'kernlab'

## The following object is masked from 'package:ggplot2':
## 
##     alpha

## The following object is masked from 'package:scales':
## 
##     alpha
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Entrenamos un modelo SVM</span>
<span class="n">modelo_svm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ksvm</span><span class="p">(</span><span class="n">os_event</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conjunto_entrenamiento</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rbfdot&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;C-svc&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">#indicamos que el objetivo es clasificacion</span>

<span class="c1"># Realizar predicciones en el conjunto de prueba</span>
<span class="n">predicciones</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">modelo_svm</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conjunto_prueba</span><span class="p">)</span>

<span class="c1"># Calcular la matriz de confusión</span>
<span class="n">confusion_matriz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conjunto_prueba</span><span class="o">$</span><span class="n">os_event</span><span class="p">,</span><span class="w"> </span><span class="n">Predicción</span><span class="w"> </span><span class="o">=</span>
<span class="n">predicciones</span><span class="p">)</span>

<span class="c1"># Calcular la precisión</span>
<span class="n">precision</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="nf">diag</span><span class="p">(</span><span class="n">confusion_matriz</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">confusion_matriz</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Precisión del modelo SVM:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">precision</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
</code></pre></div>
<pre><code>## Precisión del modelo SVM: 0.9354839
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Mostrar la matriz de confusión</span>
<span class="n">confusion_matriz</span>
</code></pre></div>
<pre><code>##     Predicción
## Real  0  1
##    0 87  0
##    1  6  0
</code></pre>
<p><strong>Dataset Preprocessing</strong></p>
<p>Rows with NA values in the selected variables were filtered out. Additionally, <code>os_event</code> was converted into a factor to enable classification. The resulting dataset was randomly split into two subsets: training (50%) and testing (50%).</p>
<p><strong>Model Training</strong></p>
<p>The <code>ksvm()</code> function from the <code>kernlab</code> package was used to train an SVM model with an <code>rbfdot</code> radial kernel. The model was fitted using the training data and then evaluated on the test set.</p>
<p><strong>Results</strong></p>
<p>The model achieved an accuracy of 93.5% on the test set. However, the confusion matrix reveals that the model failed to correctly classify any deceased patients: all deceased patients were classified as alive. This indicates that the model is biased toward the majority class (alive patients), likely due to a strong imbalance in the alive/deceased distribution. In other words, while the model appears accurate overall, its ability to detect patients with poor prognosis is zero. To correct this imbalance, we would need to add more patients with poor prognosis.</p>
<h3 id="42-pca-unsupervised-model">4.2 PCA - Unsupervised Model</h3>
<p>In this part of the work we used an unsupervised learning model to explore whether patients’ clinical data show any natural pattern or grouping without telling the model what to predict. For this, we used Principal Component Analysis (PCA).</p>
<div class="highlight"><pre><span></span><code><span class="c1"># # Filtramos filas sin valores NA en variables clave</span>
<span class="n">model_df_unsupervised</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">na.omit</span><span class="p">(</span><span class="n">df_gastro</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;age_at_initial_pathologic_diagnosis&quot;</span><span class="p">,</span>
<span class="w">                                 </span><span class="s">&quot;gender&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;residual_tumor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;stage_event_pathologic_stage&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;number_of_lymphnodes_positive_by_he&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;cancer_type&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                </span><span class="s">&quot;venous_invasion&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lymphatic_invasion&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;perineural_invasion_present&quot;</span><span class="p">)])</span>

<span class="c1"># Transformamos las variables categoricas en numericas </span>
<span class="c1"># Ref. &quot;The model.matrix function&quot; The R Book page 255</span>
<span class="n">df_numeric</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">model.matrix</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">gender</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age_at_initial_pathologic_diagnosis</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                              </span><span class="n">residual_tumor</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                              </span><span class="n">number_of_lymphnodes_positive_by_he</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                              </span><span class="n">venous_invasion</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                              </span><span class="n">lymphatic_invasion</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                              </span><span class="n">perineural_invasion_present</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                              </span><span class="n">stage_event_pathologic_stage</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model_df_unsupervised</span><span class="p">)</span>

<span class="c1"># Aplicamos PCA</span>
<span class="n">pca_resultado</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">prcomp</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="w"> </span><span class="n">center</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># Resumen de la varianza explicada por cada variable</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">pca_resultado</span><span class="p">)</span>
</code></pre></div>
<pre><code>## Importance of components:
##                           PC1    PC2     PC3    PC4     PC5     PC6     PC7
## Standard deviation     12.855 4.6032 0.81452 0.7006 0.52639 0.48330 0.43598
## Proportion of Variance  0.875 0.1122 0.00351 0.0026 0.00147 0.00124 0.00101
## Cumulative Proportion   0.875 0.9872 0.99070 0.9933 0.99477 0.99600 0.99701
##                            PC8     PC9    PC10   PC11    PC12   PC13    PC14
## Standard deviation     0.41054 0.29120 0.28441 0.2380 0.22723 0.1941 0.15327
## Proportion of Variance 0.00089 0.00045 0.00043 0.0003 0.00027 0.0002 0.00012
## Cumulative Proportion  0.99790 0.99835 0.99878 0.9991 0.99935 0.9996 0.99968
##                           PC15    PC16    PC17    PC18    PC19    PC20
## Standard deviation     0.14545 0.11274 0.10065 0.07723 0.07598 0.07337
## Proportion of Variance 0.00011 0.00007 0.00005 0.00003 0.00003 0.00003
## Cumulative Proportion  0.99979 0.99986 0.99991 0.99994 0.99997 1.00000
##                             PC21      PC22      PC23      PC24      PC25
## Standard deviation     9.744e-16 8.971e-16 8.971e-16 8.971e-16 8.971e-16
## Proportion of Variance 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00
## Cumulative Proportion  1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
##                             PC26      PC27      PC28      PC29
## Standard deviation     8.971e-16 8.971e-16 8.971e-16 8.112e-16
## Proportion of Variance 0.000e+00 0.000e+00 0.000e+00 0.000e+00
## Cumulative Proportion  1.000e+00 1.000e+00 1.000e+00 1.000e+00
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Representamos la varianza explicada por cada componente</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">pca_resultado</span><span class="p">)</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-42-1.png"
style="width:100.0%" height="500"/>
</figure>

<div class="highlight"><pre><span></span><code><span class="n">cargos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pca_resultado</span><span class="o">$</span><span class="n">rotation</span>
<span class="c1">#print(cargos)</span>
</code></pre></div>
<p><strong>PCA Results</strong></p>
<p>The first component (PC1) explains 87.5% of the total variance of the dataset, while the second component (PC2) adds an additional 11.2%. Together, PC1 and PC2 explain approximately 98.7% of the total variance, indicating that the main information in the data can be effectively summarized in two dimensions.</p>
<p>Loadings analysis revealed that:</p>
<ul>
<li>
<p>PC1 is strongly influenced by age at diagnosis, suggesting that this variable is the main driver of variability among patients.</p>
</li>
<li>
<p>PC2 is dominated by the number of positive lymph nodes, followed by a smaller contribution from variables related to tumor invasion (lymphatic, venous, and perineural).</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Realizamos agrupamiento jerárquico aglomerativo</span>
<span class="n">dist_matrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">dist</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">)</span>
<span class="c1"># Aplicamos agrupamiento jerárquico aglomerativo con el método de Ward</span>
<span class="n">hc_aglomerativo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">hclust</span><span class="p">(</span><span class="n">dist_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ward.D2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="c1"># Reprsentamos el dendrograma</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">hc_aglomerativo</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Dendrograma de Agrupamiento Jerárquico</span>
<span class="s">Aglomerativo&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Pacientes&quot;</span><span class="p">)</span>
</code></pre></div>
<figure>
<img
src="../images/unnamed-chunk-44-1.png"
style="width:100.0%" height="500"/>
</figure>

<hr />
<h2 id="5-visualization-with-shiny">5 Visualization with Shiny</h2>
<p>The Shiny application was developed to enable interactive analysis of clinical data from gastrointestinal cancer patients, using a CSV file uploaded by the user and an exploratory and visual approach based on the <code>.Rmd file</code>. The <code>gastro_app.R</code> file includes the application source code (attached in the PEC4 submission), and some screenshots are shown below to illustrate its operation.</p>
<p>Overall, the application incorporates key dataset transformations, including calculating survival time (<code>os_time</code>), death event (<code>os_event</code>), and BMI, from variables such as weight and height. In addition, new categorical variables are generated for age (<code>age_category</code>) and BMI (<code>imc_category</code>), which facilitate comparative analysis among different patient groups.</p>
<figure>
<img
src="../images/PEC4_Shiny1.png"
style="width:75.0%" height="300"
alt="Vista general de la aplicación después de cargar el archivo de datos CSV" />
<figcaption aria-hidden="true">General view of the application after loading the CSV data file</figcaption>
</figure>

<p>The application contains a sidebar with selectors that allow the user to choose variables for three main sections:</p>
<ul>
<li><strong>Survival by Clinical Variables</strong>: Shows a boxplot representing the relationship between a categorical variable (such as cancer type or tumor stage) and a quantitative variable (for example, survival time or age).</li>
</ul>
<figure>
<img
src="../images/PEC4_Shiny3.png"
style="width:75.0%" height="300"
alt="Supervivencia según variables clínicas" />
<figcaption aria-hidden="true">Survival by Clinical Variables</figcaption>
</figure>

<ul>
<li><strong>Age and BMI Distribution</strong>: Uses a bar chart to analyze frequency distribution of variables such as age and BMI, stratified by gender.  </li>
</ul>
<figure>
<img
src="../images/PEC4_Shiny4.png"
style="width:75.0%" height="300" alt="Distribución de Edades e IMC" />
<figcaption aria-hidden="true">Age and BMI Distribution</figcaption>
</figure>

<ul>
<li><strong>Kaplan-Meier Survival Analysis</strong>: Using the survival library, a Kaplan-Meier model is fitted to assess the probability of survival over time, based on selected variables such as gender or age group.  </li>
</ul>
<figure>
<img
src="../images/PEC4_Shiny5.png"
style="width:75.0%" height="300"
alt="Análisis de Supervivencia Kaplan-Meier" />
<figcaption aria-hidden="true">Kaplan-Meier Survival Analysis</figcaption>
</figure>

<hr />
<h2 id="6-conclusions">6 Conclusions</h2>
<p>The project’s objective was to analyze clinical data from gastrointestinal cancer patients obtained from the public TCGA repository (The Cancer Genome Atlas), to study possible clinical factors influencing patient survival. From the dataset of more than 1,300 cases: 1) We selected relevant variables, cleaned and transformed the data, 2) Created exploratory plots and performed statistical analyses, 3) Implemented Kaplan-Meier survival analysis, 4) Trained both a supervised model (SVM) to predict survival and an unsupervised model (PCA and hierarchical clustering) to explore natural groupings among patients, and 5) Implemented a Shiny application to facilitate interactive visualization of these data.</p>
<p>Below we describe the main findings of the TCGA dataset analysis. We also discuss limitations and areas of opportunity, and close with a comment on the team experience developing this project.</p>
<p><strong>Most Interesting Findings of Our Analysis</strong></p>
<ul>
<li>
<p>Results from parametric <code>ANOVA</code> and <code>TukeyHSD</code> tests, as well as from <code>non-parametric Kruskal-Wallis</code> and <code>Dunn tests</code>, confirmed that there are statistically significant differences between gastrointestinal cancer types and survival days for the following groups: Pancreas-Colon, Pancreas-Rectum, Stomach-Colon, and Stomach-Rectum.</p>
</li>
<li>
<p>Kaplan-Meier plots showed that women have greater survival than men, with about 65% surviving beyond 1,800 days, compared to 35% of men at 3,000 days. The log-rank test (p = 0.04) confirms that these differences are statistically significant, suggesting a more favorable clinical course for women.</p>
</li>
<li>
<p>Regarding age, younger patients have higher and more sustained survival curves, while those over 70 and 80 show faster decline. The log-rank test (p = 0.0005) shows evidence of significant differences between age groups. This is consistent with the fact that older age can be associated with higher mortality and lower treatment tolerance.</p>
</li>
<li>
<p>Finally, conditional probability analysis showed that 55.22% of patients with perineural invasion had an advanced pathological stage (type III or higher) at diagnosis. This suggests a strong association between perineural invasion and greater tumor progression.</p>
</li>
</ul>
<p><strong>Limitations of the Data and Possible Improvements or Extensions</strong></p>
<p>One of the main limitations of the analysis was the high proportion of missing data, especially in categorical variables such as <code>venous_invasion</code>, <code>lymphatic_invasion</code>, and <code>perineural_invasion_present</code>, as well as some continuous variables such as <code>days_to_death</code>, <code>weight</code>, and <code>height</code>. This reduced the effective sample size. Moreover, since this is a retrospective observational study, i.e., data come from an existing repository rather than a controlled experimental design, associations could be identified but not causal relationships. As an improvement, we could apply imputation techniques to handle missing data and validate the results with external cohorts. Additionally, some studies of this type also incorporate genomic data to enrich the analysis and provide a more comprehensive view of survival factors.</p>
<p><strong>On Teamwork and Project Evaluation</strong></p>
<p>Salomon’s Comment: Teamwork with Sefora was key to selecting the dataset, thanks to her experience in cancer research. This helped us define key questions about how certain clinical variables could affect survival in gastrointestinal cancer patients. I really enjoyed this project because it allowed me to put theoretical concepts into practice with a real dataset. I think the collaboration was effective as we divided tasks, maintained good communication, and reviewed each other’s work.</p>
<p>Sefora’s Comment: The project allowed us to apply multiple data analysis tools in R and deepen our study of survival in gastrointestinal cancer, which is the focus of my research at Vall d’Hebron Institute of Oncology. I hope to apply the same tools to analyze data from patients at my center and advance understanding of these devastating diseases. It was a pleasure working with Salomon, as we have complementary approaches and perspectives that allowed us to mutually improve our work. We had good communication and divided tasks equally.</p>
<h2 id="7-bibliography">7 Bibliography</h2>
<ol>
<li>
<p>M. F. Bijlsma, A. Sadanandam, P. Tan, L. Vermeulen, Molecular subtypes in cancers of the gastrointestinal tract. Nat Rev Gastroenterol Hepatol 14, 333–342 (2017).</p>
</li>
<li>
<p>R. L. Siegel, K. D. Miller, H. E. Fuchs, A. Jemal, Cancer statistics, 2022. CA: A Cancer Journal for Clinicians 72, 7–33 (2022).</p>
</li>
<li>
<p>J. Drost, H. Clevers, Organoids in cancer research. Nat Rev Cancer 18, 407–418 (2018).</p>
</li>
<li>
<p>P. W. Nagle, J. Th. M. Plukker, C. T. Muijs, P. van Luijk, R. P. Coppes, Patient-derived tumor organoids for prediction of cancer treatment response. Seminars in Cancer Biology 53, 258–264 (2018).</p>
</li>
<li>
<p>C. A. Pasch, P. F. Favreau, A. E. Yueh, C. P. Babiarz, A. A. Gillette, J. T. Sharick, M. R. Karim, K. P. Nickel, A. K. DeZeeuw, C. M. Sprackling, P. B. Emmerich, R. A. DeStefanis, R. T. Pitera, S. N. Payne, D. P. Korkos, L. Clipson, C. M. Walsh, D. Miller, E. H. Carchman, M. E. Burkard, K. K. Lemmon, K. A. Matkowskyj, M. A. Newton, I. M. Ong, M. F. Bassetti, R. J. Kimple, M. C. Skala, D. A. Deming, Patient-Derived Cancer Organoid Cultures to Predict Sensitivity to Chemotherapy and Radiation. Clinical Cancer Research 25, 5376–5387 (2019).</p>
</li>
<li>
<p>E. R. Zanella, E. Grassi, L. Trusolino, Towards precision oncology with patient-derived xenografts. Nat Rev Clin Oncol 19, 719–732 (2022).</p>
</li>
<li>
<p>X. Sun, B. Hu, Mathematical modeling and computational prediction of cancer drug resistance. Briefings in Bioinformatics 19, 1382–1399 (2018).</p>
</li>
<li>
<p>E. J. Mucaki, J. Z. L. Zhao, D. J. Lizotte, P. K. Rogan, Predicting responses to platin chemotherapy agents with biochemically-inspired machine learning. Sig Transduct Target Ther 4, 1–12 (2019).</p>
</li>
<li>
<p>C. Yang, X. Huang, Y. Li, J. Chen, Y. Lv, S. Dai, Prognosis and personalized treatment prediction in TP53-mutant hepatocellular carcinoma: an in silico strategy towards precision oncology. Briefings in Bioinformatics 22, bbaa164 (2021).</p>
</li>
<li>
<p>F. Li, Y. Yang, Y. Wei, P. He, J. Chen, Z. Zheng, H. Bu, Deep learning-based predictive biomarker of pathological complete response to neoadjuvant chemotherapy from histological images in breast cancer. J Transl Med 19, 348 (2021). 11. Z. Liu, Z. Li, J. Qu, R. Zhang, X. Zhou, L. Li, K. Sun, Z. Tang, H. Jiang, H. Li, Q. Xiong, Y. Ding, X. Zhao, K. Wang, Z. Liu, J. Tian, Radiomics of Multiparametric MRI for Pretreatment Prediction of Pathologic Complete Response to Neoadjuvant Chemotherapy in Breast Cancer: A Multicenter Study. Clinical Cancer Research 25, 3538–3547 (2019).</p>
</li>
</ol>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../nextflow-for-rnaseq-aws/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Nextflow RNA-seq pipelines Executed on AWS">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Nextflow RNA-seq pipelines Executed on AWS
              </div>
            </div>
          </a>
        
        
          
          <a href="../../machine-learning/classification-splice-junction/" class="md-footer__link md-footer__link--next" aria-label="Next: Classification of DNA Splice Junctions">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Classification of DNA Splice Junctions
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2025 - Salomon Marquez
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/sblaizerwize" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/sblaizer/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:phd.smarquez@gmail.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M536.4-26.3c9.8-3.5 20.6-1 28 6.3s9.8 18.2 6.3 28l-178 496.9c-5 13.9-18.1 23.1-32.8 23.1-14.2 0-27-8.6-32.3-21.7l-64.2-158c-4.5-11-2.5-23.6 5.2-32.6l94.5-112.4c5.1-6.1 4.7-15-.9-20.6s-14.6-6-20.6-.9l-112.4 94.3c-9.1 7.6-21.6 9.6-32.6 5.2L38.1 216.8c-13.1-5.3-21.7-18.1-21.7-32.3 0-14.7 9.2-27.8 23.1-32.8z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "content.tabs.link", "content.code.annotate", "content.code.copy", "content.code.select", "navigation.path", "navigation.indexes", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>